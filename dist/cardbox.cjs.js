"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var fs=_interopDefault(require("fs")),constants=_interopDefault(require("constants")),stream=_interopDefault(require("stream")),util=_interopDefault(require("util")),assert=_interopDefault(require("assert")),path$1=_interopDefault(require("path")),os=_interopDefault(require("os")),events=_interopDefault(require("events"));function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var fromCallback=function(t){return Object.defineProperty(function(){if("function"!=typeof arguments[arguments.length-1])return new Promise((e,r)=>{arguments[arguments.length]=((t,n)=>{if(t)return r(t);e(n)}),arguments.length++,t.apply(this,arguments)});t.apply(this,arguments)},"name",{value:t.name})},fromPromise=function(t){return Object.defineProperty(function(){const e=arguments[arguments.length-1];if("function"!=typeof e)return t.apply(this,arguments);t.apply(this,arguments).then(t=>e(null,t),e)},"name",{value:t.name})},universalify={fromCallback:fromCallback,fromPromise:fromPromise},origCwd=process.cwd,cwd=null,platform=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return cwd||(cwd=origCwd.call(process)),cwd};try{process.cwd()}catch(t){}var chdir=process.chdir;process.chdir=function(t){cwd=null,chdir.call(process,t)};var polyfills=patch;function patch(t){var e,r,n;function i(e){return e?function(r,n,i){return e.call(t,r,n,function(t){u(t)&&(t=null),i&&i.apply(this,arguments)})}:e}function s(e){return e?function(r,n){try{return e.call(t,r,n)}catch(t){if(!u(t))throw t}}:e}function o(e){return e?function(r,n,i,s){return e.call(t,r,n,i,function(t){u(t)&&(t=null),s&&s.apply(this,arguments)})}:e}function c(e){return e?function(r,n,i){try{return e.call(t,r,n,i)}catch(t){if(!u(t))throw t}}:e}function a(e){return e?function(r,n){return e.call(t,r,function(t,e){if(!e)return n.apply(this,arguments);e.uid<0&&(e.uid+=4294967296),e.gid<0&&(e.gid+=4294967296),n&&n.apply(this,arguments)})}:e}function l(e){return e?function(r){var n=e.call(t,r);return n.uid<0&&(n.uid+=4294967296),n.gid<0&&(n.gid+=4294967296),n}:e}function u(t){return!t||("ENOSYS"===t.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==t.code&&"EPERM"!==t.code))}constants.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(t){t.lchmod=function(e,r,n){t.open(e,constants.O_WRONLY|constants.O_SYMLINK,r,function(e,i){e?n&&n(e):t.fchmod(i,r,function(e){t.close(i,function(t){n&&n(e||t)})})})},t.lchmodSync=function(e,r){var n,i=t.openSync(e,constants.O_WRONLY|constants.O_SYMLINK,r),s=!0;try{n=t.fchmodSync(i,r),s=!1}finally{if(s)try{t.closeSync(i)}catch(t){}else t.closeSync(i)}return n}}(t),t.lutimes||function(t){constants.hasOwnProperty("O_SYMLINK")?(t.lutimes=function(e,r,n,i){t.open(e,constants.O_SYMLINK,function(e,s){e?i&&i(e):t.futimes(s,r,n,function(e){t.close(s,function(t){i&&i(e||t)})})})},t.lutimesSync=function(e,r,n){var i,s=t.openSync(e,constants.O_SYMLINK),o=!0;try{i=t.futimesSync(s,r,n),o=!1}finally{if(o)try{t.closeSync(s)}catch(t){}else t.closeSync(s)}return i}):(t.lutimes=function(t,e,r,n){n&&process.nextTick(n)},t.lutimesSync=function(){})}(t),t.chown=o(t.chown),t.fchown=o(t.fchown),t.lchown=o(t.lchown),t.chmod=i(t.chmod),t.fchmod=i(t.fchmod),t.lchmod=i(t.lchmod),t.chownSync=c(t.chownSync),t.fchownSync=c(t.fchownSync),t.lchownSync=c(t.lchownSync),t.chmodSync=s(t.chmodSync),t.fchmodSync=s(t.fchmodSync),t.lchmodSync=s(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=l(t.statSync),t.fstatSync=l(t.fstatSync),t.lstatSync=l(t.lstatSync),t.lchmod||(t.lchmod=function(t,e,r){r&&process.nextTick(r)},t.lchmodSync=function(){}),t.lchown||(t.lchown=function(t,e,r,n){n&&process.nextTick(n)},t.lchownSync=function(){}),"win32"===platform&&(t.rename=(e=t.rename,function(r,n,i){var s=Date.now(),o=0;e(r,n,function c(a){if(a&&("EACCES"===a.code||"EPERM"===a.code)&&Date.now()-s<6e4)return setTimeout(function(){t.stat(n,function(t,s){t&&"ENOENT"===t.code?e(r,n,c):i(a)})},o),void(o<100&&(o+=10));i&&i(a)})})),t.read=(r=t.read,function(e,n,i,s,o,c){var a;if(c&&"function"==typeof c){var l=0;a=function(u,f,h){if(u&&"EAGAIN"===u.code&&l<10)return l++,r.call(t,e,n,i,s,o,a);c.apply(this,arguments)}}return r.call(t,e,n,i,s,o,a)}),t.readSync=(n=t.readSync,function(e,r,i,s,o){for(var c=0;;)try{return n.call(t,e,r,i,s,o)}catch(t){if("EAGAIN"===t.code&&c<10){c++;continue}throw t}})}var Stream=stream.Stream,legacyStreams=legacy;function legacy(t){return{ReadStream:function e(r,n){if(!(this instanceof e))return new e(r,n);Stream.call(this);var i=this;this.path=r;this.fd=null;this.readable=!0;this.paused=!1;this.flags="r";this.mode=438;this.bufferSize=65536;n=n||{};var s=Object.keys(n);for(var o=0,c=s.length;o<c;o++){var a=s[o];this[a]=n[a]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick(function(){i._read()});t.open(this.path,this.flags,this.mode,function(t,e){if(t)return i.emit("error",t),void(i.readable=!1);i.fd=e,i.emit("open",e),i._read()})},WriteStream:function e(r,n){if(!(this instanceof e))return new e(r,n);Stream.call(this);this.path=r;this.fd=null;this.writable=!0;this.flags="w";this.encoding="binary";this.mode=438;this.bytesWritten=0;n=n||{};var i=Object.keys(n);for(var s=0,o=i.length;s<o;s++){var c=i[s];this[c]=n[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1;this._queue=[];null===this.fd&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}var clone_1=clone;function clone(t){if(null===t||"object"!=typeof t)return t;if(t instanceof Object)var e={__proto__:t.__proto__};else e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var gracefulFs=createCommonjsModule(function(t){var e=[];var r,n,i=function(){};function s(t){polyfills(t),t.gracefulify=s,t.FileReadStream=h,t.FileWriteStream=p,t.createReadStream=function(t,e){return new h(t,e)},t.createWriteStream=function(t,e){return new p(t,e)};var e=t.readFile;t.readFile=function(t,r,n){"function"==typeof r&&(n=r,r=null);return function t(r,n,i){return e(r,n,function(e){!e||"EMFILE"!==e.code&&"ENFILE"!==e.code?("function"==typeof i&&i.apply(this,arguments),c()):o([t,[r,n,i]])})}(t,r,n)};var r=t.writeFile;t.writeFile=function(t,e,n,i){"function"==typeof n&&(i=n,n=null);return function t(e,n,i,s){return r(e,n,i,function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?("function"==typeof s&&s.apply(this,arguments),c()):o([t,[e,n,i,s]])})}(t,e,n,i)};var n=t.appendFile;n&&(t.appendFile=function(t,e,r,i){"function"==typeof r&&(i=r,r=null);return function t(e,r,i,s){return n(e,r,i,function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?("function"==typeof s&&s.apply(this,arguments),c()):o([t,[e,r,i,s]])})}(t,e,r,i)});var i=t.readdir;function a(e){return i.apply(t,e)}if(t.readdir=function(t,e,r){var n=[t];"function"!=typeof e?n.push(e):r=e;return n.push(function(t,e){e&&e.sort&&e.sort(),!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?("function"==typeof r&&r.apply(this,arguments),c()):o([a,[n]])}),a(n)},"v0.8"===process.version.substr(0,4)){var l=legacyStreams(t);h=l.ReadStream,p=l.WriteStream}var u=t.ReadStream;u&&(h.prototype=Object.create(u.prototype),h.prototype.open=function(){var t=this;y(t.path,t.flags,t.mode,function(e,r){e?(t.autoClose&&t.destroy(),t.emit("error",e)):(t.fd=r,t.emit("open",r),t.read())})});var f=t.WriteStream;function h(t,e){return this instanceof h?(u.apply(this,arguments),this):h.apply(Object.create(h.prototype),arguments)}function p(t,e){return this instanceof p?(f.apply(this,arguments),this):p.apply(Object.create(p.prototype),arguments)}f&&(p.prototype=Object.create(f.prototype),p.prototype.open=function(){var t=this;y(t.path,t.flags,t.mode,function(e,r){e?(t.destroy(),t.emit("error",e)):(t.fd=r,t.emit("open",r))})}),t.ReadStream=h,t.WriteStream=p;var m=t.open;function y(t,e,r,n){return"function"==typeof r&&(n=r,r=null),function t(e,r,n,i){return m(e,r,n,function(s,a){!s||"EMFILE"!==s.code&&"ENFILE"!==s.code?("function"==typeof i&&i.apply(this,arguments),c()):o([t,[e,r,n,i]])})}(t,e,r,n)}return t.open=y,t}function o(t){i("ENQUEUE",t[0].name,t[1]),e.push(t)}function c(){var t=e.shift();t&&(i("RETRY",t[0].name,t[1]),t[0].apply(null,t[1]))}util.debuglog?i=util.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(i=function(){var t=util.format.apply(util,arguments);t="GFS4: "+t.split(/\n/).join("\nGFS4: "),console.error(t)}),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){i(e),assert.equal(e.length,0)}),t.exports=s(clone_1(fs)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!fs.__patched&&(t.exports=s(fs),fs.__patched=!0),t.exports.close=(r=fs.close,function(t,e){return r.call(fs,t,function(t){t||c(),"function"==typeof e&&e.apply(this,arguments)})}),t.exports.closeSync=(n=fs.closeSync,function(t){var e=n.apply(fs,arguments);return c(),e}),/\bgraceful-fs\b/.test(fs.closeSync.toString())||(fs.closeSync=t.exports.closeSync,fs.close=t.exports.close)}),gracefulFs_1=gracefulFs.close,gracefulFs_2=gracefulFs.closeSync,fs_1=createCommonjsModule(function(t,e){const r=universalify.fromCallback,n=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>"function"==typeof gracefulFs[t]);Object.keys(gracefulFs).forEach(t=>{"promises"!==t&&(e[t]=gracefulFs[t])}),n.forEach(t=>{e[t]=r(gracefulFs[t])}),e.exists=function(t,e){return"function"==typeof e?gracefulFs.exists(t,e):new Promise(e=>gracefulFs.exists(t,e))},e.read=function(t,e,r,n,i,s){return"function"==typeof s?gracefulFs.read(t,e,r,n,i,s):new Promise((s,o)=>{gracefulFs.read(t,e,r,n,i,(t,e,r)=>{if(t)return o(t);s({bytesRead:e,buffer:r})})})},e.write=function(t,e,...r){return"function"==typeof r[r.length-1]?gracefulFs.write(t,e,...r):new Promise((n,i)=>{gracefulFs.write(t,e,...r,(t,e,r)=>{if(t)return i(t);n({bytesWritten:e,buffer:r})})})}}),fs_2=fs_1.exists,fs_3=fs_1.read,fs_4=fs_1.write;function getRootPath(t){return(t=path$1.normalize(path$1.resolve(t)).split(path$1.sep)).length>0?t[0]:null}const INVALID_PATH_CHARS=/[<>:"|?*]/;function invalidWin32Path(t){const e=getRootPath(t);return t=t.replace(e,""),INVALID_PATH_CHARS.test(t)}var win32={getRootPath:getRootPath,invalidWin32Path:invalidWin32Path};const invalidWin32Path$1=win32.invalidWin32Path,o777=parseInt("0777",8);function mkdirs(t,e,r,n){if("function"==typeof e?(r=e,e={}):e&&"object"==typeof e||(e={mode:e}),"win32"===process.platform&&invalidWin32Path$1(t)){const e=new Error(t+" contains invalid WIN32 path characters.");return e.code="EINVAL",r(e)}let i=e.mode;const s=e.fs||gracefulFs;void 0===i&&(i=o777&~process.umask()),n||(n=null),r=r||function(){},t=path$1.resolve(t),s.mkdir(t,i,i=>{if(!i)return r(null,n=n||t);switch(i.code){case"ENOENT":if(path$1.dirname(t)===t)return r(i);mkdirs(path$1.dirname(t),e,(n,i)=>{n?r(n,i):mkdirs(t,e,r,i)});break;default:s.stat(t,(t,e)=>{t||!e.isDirectory()?r(i,n):r(null,n)})}})}var mkdirs_1=mkdirs;const invalidWin32Path$2=win32.invalidWin32Path,o777$1=parseInt("0777",8);function mkdirsSync(t,e,r){e&&"object"==typeof e||(e={mode:e});let n=e.mode;const i=e.fs||gracefulFs;if("win32"===process.platform&&invalidWin32Path$2(t)){const e=new Error(t+" contains invalid WIN32 path characters.");throw e.code="EINVAL",e}void 0===n&&(n=o777$1&~process.umask()),r||(r=null),t=path$1.resolve(t);try{i.mkdirSync(t,n),r=r||t}catch(n){if("ENOENT"===n.code){if(path$1.dirname(t)===t)throw n;r=mkdirsSync(path$1.dirname(t),e,r),mkdirsSync(t,e,r)}else{let e;try{e=i.statSync(t)}catch(t){throw n}if(!e.isDirectory())throw n}}return r}var mkdirsSync_1=mkdirsSync;const u=universalify.fromCallback,mkdirs$1=u(mkdirs_1);var mkdirs_1$1={mkdirs:mkdirs$1,mkdirsSync:mkdirsSync_1,mkdirp:mkdirs$1,mkdirpSync:mkdirsSync_1,ensureDir:mkdirs$1,ensureDirSync:mkdirsSync_1};function hasMillisResSync(){let t=path$1.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));t=path$1.join(os.tmpdir(),t);const e=new Date(1435410243862);gracefulFs.writeFileSync(t,"https://github.com/jprichardson/node-fs-extra/pull/141");const r=gracefulFs.openSync(t,"r+");return gracefulFs.futimesSync(r,e,e),gracefulFs.closeSync(r),gracefulFs.statSync(t).mtime>1435410243e3}function hasMillisRes(t){let e=path$1.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));e=path$1.join(os.tmpdir(),e);const r=new Date(1435410243862);gracefulFs.writeFile(e,"https://github.com/jprichardson/node-fs-extra/pull/141",n=>{if(n)return t(n);gracefulFs.open(e,"r+",(n,i)=>{if(n)return t(n);gracefulFs.futimes(i,r,r,r=>{if(r)return t(r);gracefulFs.close(i,r=>{if(r)return t(r);gracefulFs.stat(e,(e,r)=>{if(e)return t(e);t(null,r.mtime>1435410243e3)})})})})})}function timeRemoveMillis(t){if("number"==typeof t)return 1e3*Math.floor(t/1e3);if(t instanceof Date)return new Date(1e3*Math.floor(t.getTime()/1e3));throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")}function utimesMillis(t,e,r,n){gracefulFs.open(t,"r+",(t,i)=>{if(t)return n(t);gracefulFs.futimes(i,e,r,t=>{gracefulFs.close(i,e=>{n&&n(t||e)})})})}function utimesMillisSync(t,e,r){const n=gracefulFs.openSync(t,"r+");return gracefulFs.futimesSync(n,e,r),gracefulFs.closeSync(n)}var utimes={hasMillisRes:hasMillisRes,hasMillisResSync:hasMillisResSync,timeRemoveMillis:timeRemoveMillis,utimesMillis:utimesMillis,utimesMillisSync:utimesMillisSync},buffer=function(t){if("function"==typeof Buffer.allocUnsafe)try{return Buffer.allocUnsafe(t)}catch(e){return new Buffer(t)}return new Buffer(t)};const mkdirpSync=mkdirs_1$1.mkdirsSync,utimesSync=utimes.utimesMillisSync,notExist=Symbol("notExist");function copySync(t,e,r){"function"==typeof r&&(r={filter:r}),(r=r||{}).clobber=!("clobber"in r)||!!r.clobber,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269");const n=checkPaths(t,e);if(r.filter&&!r.filter(t,e))return;const i=path$1.dirname(e);return gracefulFs.existsSync(i)||mkdirpSync(i),startCopy(n,t,e,r)}function startCopy(t,e,r,n){if(!n.filter||n.filter(e,r))return getStats(t,e,r,n)}function getStats(t,e,r,n){const i=(n.dereference?gracefulFs.statSync:gracefulFs.lstatSync)(e);return i.isDirectory()?onDir(i,t,e,r,n):i.isFile()||i.isCharacterDevice()||i.isBlockDevice()?onFile(i,t,e,r,n):i.isSymbolicLink()?onLink(t,e,r,n):void 0}function onFile(t,e,r,n,i){return e===notExist?copyFile(t,r,n,i):mayCopyFile(t,r,n,i)}function mayCopyFile(t,e,r,n){if(n.overwrite)return gracefulFs.unlinkSync(r),copyFile(t,e,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function copyFile(t,e,r,n){return"function"==typeof gracefulFs.copyFileSync?(gracefulFs.copyFileSync(e,r),gracefulFs.chmodSync(r,t.mode),n.preserveTimestamps?utimesSync(r,t.atime,t.mtime):void 0):copyFileFallback(t,e,r,n)}function copyFileFallback(t,e,r,n){const i=buffer(65536),s=gracefulFs.openSync(e,"r"),o=gracefulFs.openSync(r,"w",t.mode);let c=0;for(;c<t.size;){const t=gracefulFs.readSync(s,i,0,65536,c);gracefulFs.writeSync(o,i,0,t),c+=t}n.preserveTimestamps&&gracefulFs.futimesSync(o,t.atime,t.mtime),gracefulFs.closeSync(s),gracefulFs.closeSync(o)}function onDir(t,e,r,n,i){if(e===notExist)return mkDirAndCopy(t,r,n,i);if(e&&!e.isDirectory())throw new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`);return copyDir(r,n,i)}function mkDirAndCopy(t,e,r,n){return gracefulFs.mkdirSync(r),copyDir(e,r,n),gracefulFs.chmodSync(r,t.mode)}function copyDir(t,e,r){gracefulFs.readdirSync(t).forEach(n=>copyDirItem(n,t,e,r))}function copyDirItem(t,e,r,n){const i=path$1.join(e,t),s=path$1.join(r,t);return startCopy(checkPaths(i,s),i,s,n)}function onLink(t,e,r,n){let i=gracefulFs.readlinkSync(e);if(n.dereference&&(i=path$1.resolve(process.cwd(),i)),t===notExist)return gracefulFs.symlinkSync(i,r);{let t;try{t=gracefulFs.readlinkSync(r)}catch(t){if("EINVAL"===t.code||"UNKNOWN"===t.code)return gracefulFs.symlinkSync(i,r);throw t}if(n.dereference&&(t=path$1.resolve(process.cwd(),t)),isSrcSubdir(i,t))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${t}'.`);if(gracefulFs.statSync(r).isDirectory()&&isSrcSubdir(t,i))throw new Error(`Cannot overwrite '${t}' with '${i}'.`);return copyLink(i,r)}}function copyLink(t,e){return gracefulFs.unlinkSync(e),gracefulFs.symlinkSync(t,e)}function isSrcSubdir(t,e){const r=path$1.resolve(t).split(path$1.sep),n=path$1.resolve(e).split(path$1.sep);return r.reduce((t,e,r)=>t&&n[r]===e,!0)}function checkStats(t,e){const r=gracefulFs.statSync(t);let n;try{n=gracefulFs.statSync(e)}catch(t){if("ENOENT"===t.code)return{srcStat:r,destStat:notExist};throw t}return{srcStat:r,destStat:n}}function checkPaths(t,e){const{srcStat:r,destStat:n}=checkStats(t,e);if(n.ino&&n.ino===r.ino)throw new Error("Source and destination must not be the same.");if(r.isDirectory()&&isSrcSubdir(t,e))throw new Error(`Cannot copy '${t}' to a subdirectory of itself, '${e}'.`);return n}var copySync_1=copySync,copySync$1={copySync:copySync_1};const u$1=universalify.fromPromise;function pathExists(t){return fs_1.access(t).then(()=>!0).catch(()=>!1)}var pathExists_1={pathExists:u$1(pathExists),pathExistsSync:fs_1.existsSync};const mkdirp=mkdirs_1$1.mkdirs,pathExists$1=pathExists_1.pathExists,utimes$1=utimes.utimesMillis,notExist$1=Symbol("notExist");function copy(t,e,r,n){"function"!=typeof r||n?"function"==typeof r&&(r={filter:r}):(n=r,r={}),n=n||function(){},(r=r||{}).clobber=!("clobber"in r)||!!r.clobber,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269"),checkPaths$1(t,e,(i,s)=>i?n(i):r.filter?handleFilter(checkParentDir,s,t,e,r,n):checkParentDir(s,t,e,r,n))}function checkParentDir(t,e,r,n,i){const s=path$1.dirname(r);pathExists$1(s,(o,c)=>o?i(o):c?startCopy$1(t,e,r,n,i):void mkdirp(s,s=>s?i(s):startCopy$1(t,e,r,n,i)))}function handleFilter(t,e,r,n,i,s){Promise.resolve(i.filter(r,n)).then(o=>o?e?t(e,r,n,i,s):t(r,n,i,s):s(),t=>s(t))}function startCopy$1(t,e,r,n,i){return n.filter?handleFilter(getStats$1,t,e,r,n,i):getStats$1(t,e,r,n,i)}function getStats$1(t,e,r,n,i){(n.dereference?gracefulFs.stat:gracefulFs.lstat)(e,(s,o)=>s?i(s):o.isDirectory()?onDir$1(o,t,e,r,n,i):o.isFile()||o.isCharacterDevice()||o.isBlockDevice()?onFile$1(o,t,e,r,n,i):o.isSymbolicLink()?onLink$1(t,e,r,n,i):void 0)}function onFile$1(t,e,r,n,i,s){return e===notExist$1?copyFile$1(t,r,n,i,s):mayCopyFile$1(t,r,n,i,s)}function mayCopyFile$1(t,e,r,n,i){if(!n.overwrite)return n.errorOnExist?i(new Error(`'${r}' already exists`)):i();gracefulFs.unlink(r,s=>s?i(s):copyFile$1(t,e,r,n,i))}function copyFile$1(t,e,r,n,i){return"function"==typeof gracefulFs.copyFile?gracefulFs.copyFile(e,r,e=>e?i(e):setDestModeAndTimestamps(t,r,n,i)):copyFileFallback$1(t,e,r,n,i)}function copyFileFallback$1(t,e,r,n,i){const s=gracefulFs.createReadStream(e);s.on("error",t=>i(t)).once("open",()=>{const e=gracefulFs.createWriteStream(r,{mode:t.mode});e.on("error",t=>i(t)).on("open",()=>s.pipe(e)).once("close",()=>setDestModeAndTimestamps(t,r,n,i))})}function setDestModeAndTimestamps(t,e,r,n){gracefulFs.chmod(e,t.mode,i=>i?n(i):r.preserveTimestamps?utimes$1(e,t.atime,t.mtime,n):n())}function onDir$1(t,e,r,n,i,s){return e===notExist$1?mkDirAndCopy$1(t,r,n,i,s):e&&!e.isDirectory()?s(new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`)):copyDir$1(r,n,i,s)}function mkDirAndCopy$1(t,e,r,n,i){gracefulFs.mkdir(r,s=>{if(s)return i(s);copyDir$1(e,r,n,e=>e?i(e):gracefulFs.chmod(r,t.mode,i))})}function copyDir$1(t,e,r,n){gracefulFs.readdir(t,(i,s)=>i?n(i):copyDirItems(s,t,e,r,n))}function copyDirItems(t,e,r,n,i){const s=t.pop();return s?copyDirItem$1(t,s,e,r,n,i):i()}function copyDirItem$1(t,e,r,n,i,s){const o=path$1.join(r,e),c=path$1.join(n,e);checkPaths$1(o,c,(e,a)=>{if(e)return s(e);startCopy$1(a,o,c,i,e=>e?s(e):copyDirItems(t,r,n,i,s))})}function onLink$1(t,e,r,n,i){gracefulFs.readlink(e,(e,s)=>e?i(e):(n.dereference&&(s=path$1.resolve(process.cwd(),s)),t===notExist$1?gracefulFs.symlink(s,r,i):void gracefulFs.readlink(r,(e,o)=>e?"EINVAL"===e.code||"UNKNOWN"===e.code?gracefulFs.symlink(s,r,i):i(e):(n.dereference&&(o=path$1.resolve(process.cwd(),o)),isSrcSubdir$1(s,o)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${o}'.`)):t.isDirectory()&&isSrcSubdir$1(o,s)?i(new Error(`Cannot overwrite '${o}' with '${s}'.`)):copyLink$1(s,r,i)))))}function copyLink$1(t,e,r){gracefulFs.unlink(e,n=>n?r(n):gracefulFs.symlink(t,e,r))}function isSrcSubdir$1(t,e){const r=path$1.resolve(t).split(path$1.sep),n=path$1.resolve(e).split(path$1.sep);return r.reduce((t,e,r)=>t&&n[r]===e,!0)}function checkStats$1(t,e,r){gracefulFs.stat(t,(t,n)=>{if(t)return r(t);gracefulFs.stat(e,(t,e)=>t?"ENOENT"===t.code?r(null,{srcStat:n,destStat:notExist$1}):r(t):r(null,{srcStat:n,destStat:e}))})}function checkPaths$1(t,e,r){checkStats$1(t,e,(n,i)=>{if(n)return r(n);const{srcStat:s,destStat:o}=i;return o.ino&&o.ino===s.ino?r(new Error("Source and destination must not be the same.")):s.isDirectory()&&isSrcSubdir$1(t,e)?r(new Error(`Cannot copy '${t}' to a subdirectory of itself, '${e}'.`)):r(null,o)})}var copy_1=copy;const u$2=universalify.fromCallback;var copy$1={copy:u$2(copy_1)};const isWindows="win32"===process.platform;function defaults(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(e=>{t[e]=t[e]||gracefulFs[e],t[e+="Sync"]=t[e]||gracefulFs[e]}),t.maxBusyTries=t.maxBusyTries||3}function rimraf(t,e,r){let n=0;"function"==typeof e&&(r=e,e={}),assert(t,"rimraf: missing path"),assert.strictEqual(typeof t,"string","rimraf: path should be a string"),assert.strictEqual(typeof r,"function","rimraf: callback function required"),assert(e,"rimraf: invalid options argument provided"),assert.strictEqual(typeof e,"object","rimraf: options should be object"),defaults(e),rimraf_(t,e,function i(s){if(s){if(("EBUSY"===s.code||"ENOTEMPTY"===s.code||"EPERM"===s.code)&&n<e.maxBusyTries){return n++,setTimeout(()=>rimraf_(t,e,i),100*n)}"ENOENT"===s.code&&(s=null)}r(s)})}function rimraf_(t,e,r){assert(t),assert(e),assert("function"==typeof r),e.lstat(t,(n,i)=>n&&"ENOENT"===n.code?r(null):n&&"EPERM"===n.code&&isWindows?fixWinEPERM(t,e,n,r):i&&i.isDirectory()?rmdir(t,e,n,r):void e.unlink(t,n=>{if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return isWindows?fixWinEPERM(t,e,n,r):rmdir(t,e,n,r);if("EISDIR"===n.code)return rmdir(t,e,n,r)}return r(n)}))}function fixWinEPERM(t,e,r,n){assert(t),assert(e),assert("function"==typeof n),r&&assert(r instanceof Error),e.chmod(t,438,i=>{i?n("ENOENT"===i.code?null:r):e.stat(t,(i,s)=>{i?n("ENOENT"===i.code?null:r):s.isDirectory()?rmdir(t,e,r,n):e.unlink(t,n)})})}function fixWinEPERMSync(t,e,r){let n;assert(t),assert(e),r&&assert(r instanceof Error);try{e.chmodSync(t,438)}catch(t){if("ENOENT"===t.code)return;throw r}try{n=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw r}n.isDirectory()?rmdirSync(t,e,r):e.unlinkSync(t)}function rmdir(t,e,r,n){assert(t),assert(e),r&&assert(r instanceof Error),assert("function"==typeof n),e.rmdir(t,i=>{!i||"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code?i&&"ENOTDIR"===i.code?n(r):n(i):rmkids(t,e,n)})}function rmkids(t,e,r){assert(t),assert(e),assert("function"==typeof r),e.readdir(t,(n,i)=>{if(n)return r(n);let s,o=i.length;if(0===o)return e.rmdir(t,r);i.forEach(n=>{rimraf(path$1.join(t,n),e,n=>{if(!s)return n?r(s=n):void(0==--o&&e.rmdir(t,r))})})})}function rimrafSync(t,e){let r;defaults(e=e||{}),assert(t,"rimraf: missing path"),assert.strictEqual(typeof t,"string","rimraf: path should be a string"),assert(e,"rimraf: missing options"),assert.strictEqual(typeof e,"object","rimraf: options should be object");try{r=e.lstatSync(t)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&isWindows&&fixWinEPERMSync(t,e,r)}try{r&&r.isDirectory()?rmdirSync(t,e,null):e.unlinkSync(t)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return isWindows?fixWinEPERMSync(t,e,r):rmdirSync(t,e,r);if("EISDIR"!==r.code)throw r;rmdirSync(t,e,r)}}function rmdirSync(t,e,r){assert(t),assert(e),r&&assert(r instanceof Error);try{e.rmdirSync(t)}catch(n){if("ENOTDIR"===n.code)throw r;if("ENOTEMPTY"===n.code||"EEXIST"===n.code||"EPERM"===n.code)rmkidsSync(t,e);else if("ENOENT"!==n.code)throw n}}function rmkidsSync(t,e){if(assert(t),assert(e),e.readdirSync(t).forEach(r=>rimrafSync(path$1.join(t,r),e)),!isWindows){return e.rmdirSync(t,e)}{const r=Date.now();do{try{return e.rmdirSync(t,e)}catch(t){}}while(Date.now()-r<500)}}var rimraf_1=rimraf;rimraf.sync=rimrafSync;const u$3=universalify.fromCallback;var remove={remove:u$3(rimraf_1),removeSync:rimraf_1.sync};const u$4=universalify.fromCallback,emptyDir=u$4(function(t,e){e=e||function(){},fs.readdir(t,(r,n)=>{if(r)return mkdirs_1$1.mkdirs(t,e);n=n.map(e=>path$1.join(t,e)),function t(){const r=n.pop();if(!r)return e();remove.remove(r,r=>{if(r)return e(r);t()})}()})});function emptyDirSync(t){let e;try{e=fs.readdirSync(t)}catch(e){return mkdirs_1$1.mkdirsSync(t)}e.forEach(e=>{e=path$1.join(t,e),remove.removeSync(e)})}var empty={emptyDirSync:emptyDirSync,emptydirSync:emptyDirSync,emptyDir:emptyDir,emptydir:emptyDir};const u$5=universalify.fromCallback,pathExists$2=pathExists_1.pathExists;function createFile(t,e){function r(){gracefulFs.writeFile(t,"",t=>{if(t)return e(t);e()})}gracefulFs.stat(t,(n,i)=>{if(!n&&i.isFile())return e();const s=path$1.dirname(t);pathExists$2(s,(t,n)=>t?e(t):n?r():void mkdirs_1$1.mkdirs(s,t=>{if(t)return e(t);r()}))})}function createFileSync(t){let e;try{e=gracefulFs.statSync(t)}catch(t){}if(e&&e.isFile())return;const r=path$1.dirname(t);gracefulFs.existsSync(r)||mkdirs_1$1.mkdirsSync(r),gracefulFs.writeFileSync(t,"")}var file={createFile:u$5(createFile),createFileSync:createFileSync};const u$6=universalify.fromCallback,pathExists$3=pathExists_1.pathExists;function createLink(t,e,r){function n(t,e){gracefulFs.link(t,e,t=>{if(t)return r(t);r(null)})}pathExists$3(e,(i,s)=>i?r(i):s?r(null):void gracefulFs.lstat(t,i=>{if(i)return i.message=i.message.replace("lstat","ensureLink"),r(i);const s=path$1.dirname(e);pathExists$3(s,(i,o)=>i?r(i):o?n(t,e):void mkdirs_1$1.mkdirs(s,i=>{if(i)return r(i);n(t,e)}))}))}function createLinkSync(t,e){if(gracefulFs.existsSync(e))return;try{gracefulFs.lstatSync(t)}catch(t){throw t.message=t.message.replace("lstat","ensureLink"),t}const r=path$1.dirname(e);return gracefulFs.existsSync(r)?gracefulFs.linkSync(t,e):(mkdirs_1$1.mkdirsSync(r),gracefulFs.linkSync(t,e))}var link={createLink:u$6(createLink),createLinkSync:createLinkSync};const pathExists$4=pathExists_1.pathExists;function symlinkPaths(t,e,r){if(path$1.isAbsolute(t))return gracefulFs.lstat(t,e=>e?(e.message=e.message.replace("lstat","ensureSymlink"),r(e)):r(null,{toCwd:t,toDst:t}));{const n=path$1.dirname(e),i=path$1.join(n,t);return pathExists$4(i,(e,s)=>e?r(e):s?r(null,{toCwd:i,toDst:t}):gracefulFs.lstat(t,e=>e?(e.message=e.message.replace("lstat","ensureSymlink"),r(e)):r(null,{toCwd:t,toDst:path$1.relative(n,t)})))}}function symlinkPathsSync(t,e){let r;if(path$1.isAbsolute(t)){if(!(r=gracefulFs.existsSync(t)))throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}{const n=path$1.dirname(e),i=path$1.join(n,t);if(r=gracefulFs.existsSync(i))return{toCwd:i,toDst:t};if(!(r=gracefulFs.existsSync(t)))throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:path$1.relative(n,t)}}}var symlinkPaths_1={symlinkPaths:symlinkPaths,symlinkPathsSync:symlinkPathsSync};function symlinkType(t,e,r){if(r="function"==typeof e?e:r,e="function"!=typeof e&&e)return r(null,e);gracefulFs.lstat(t,(t,n)=>{if(t)return r(null,"file");e=n&&n.isDirectory()?"dir":"file",r(null,e)})}function symlinkTypeSync(t,e){let r;if(e)return e;try{r=gracefulFs.lstatSync(t)}catch(t){return"file"}return r&&r.isDirectory()?"dir":"file"}var symlinkType_1={symlinkType:symlinkType,symlinkTypeSync:symlinkTypeSync};const u$7=universalify.fromCallback,mkdirs$2=mkdirs_1$1.mkdirs,mkdirsSync$1=mkdirs_1$1.mkdirsSync,symlinkPaths$1=symlinkPaths_1.symlinkPaths,symlinkPathsSync$1=symlinkPaths_1.symlinkPathsSync,symlinkType$1=symlinkType_1.symlinkType,symlinkTypeSync$1=symlinkType_1.symlinkTypeSync,pathExists$5=pathExists_1.pathExists;function createSymlink(t,e,r,n){n="function"==typeof r?r:n,r="function"!=typeof r&&r,pathExists$5(e,(i,s)=>i?n(i):s?n(null):void symlinkPaths$1(t,e,(i,s)=>{if(i)return n(i);t=s.toDst,symlinkType$1(s.toCwd,r,(r,i)=>{if(r)return n(r);const s=path$1.dirname(e);pathExists$5(s,(r,o)=>r?n(r):o?gracefulFs.symlink(t,e,i,n):void mkdirs$2(s,r=>{if(r)return n(r);gracefulFs.symlink(t,e,i,n)}))})}))}function createSymlinkSync(t,e,r){if(gracefulFs.existsSync(e))return;const n=symlinkPathsSync$1(t,e);t=n.toDst,r=symlinkTypeSync$1(n.toCwd,r);const i=path$1.dirname(e);return gracefulFs.existsSync(i)?gracefulFs.symlinkSync(t,e,r):(mkdirsSync$1(i),gracefulFs.symlinkSync(t,e,r))}var _fs,symlink={createSymlink:u$7(createSymlink),createSymlinkSync:createSymlinkSync},ensure={createFile:file.createFile,createFileSync:file.createFileSync,ensureFile:file.createFile,ensureFileSync:file.createFileSync,createLink:link.createLink,createLinkSync:link.createLinkSync,ensureLink:link.createLink,ensureLinkSync:link.createLinkSync,createSymlink:symlink.createSymlink,createSymlinkSync:symlink.createSymlinkSync,ensureSymlink:symlink.createSymlink,ensureSymlinkSync:symlink.createSymlinkSync};try{_fs=gracefulFs}catch(t){_fs=fs}function readFile(t,e,r){null==r&&(r=e,e={}),"string"==typeof e&&(e={encoding:e});var n=(e=e||{}).fs||_fs,i=!0;"throws"in e&&(i=e.throws),n.readFile(t,e,function(n,s){if(n)return r(n);var o;s=stripBom(s);try{o=JSON.parse(s,e?e.reviver:null)}catch(e){return i?(e.message=t+": "+e.message,r(e)):r(null,null)}r(null,o)})}function readFileSync(t,e){"string"==typeof(e=e||{})&&(e={encoding:e});var r=e.fs||_fs,n=!0;"throws"in e&&(n=e.throws);try{var i=r.readFileSync(t,e);return i=stripBom(i),JSON.parse(i,e.reviver)}catch(e){if(n)throw e.message=t+": "+e.message,e;return null}}function stringify(t,e){var r,n="\n";return"object"==typeof e&&null!==e&&(e.spaces&&(r=e.spaces),e.EOL&&(n=e.EOL)),JSON.stringify(t,e?e.replacer:null,r).replace(/\n/g,n)+n}function writeFile(t,e,r,n){null==n&&(n=r,r={});var i=(r=r||{}).fs||_fs,s="";try{s=stringify(e,r)}catch(t){return void(n&&n(t,null))}i.writeFile(t,s,r,n)}function writeFileSync(t,e,r){var n=(r=r||{}).fs||_fs,i=stringify(e,r);return n.writeFileSync(t,i,r)}function stripBom(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t=t.replace(/^\uFEFF/,"")}var jsonfile={readFile:readFile,readFileSync:readFileSync,writeFile:writeFile,writeFileSync:writeFileSync},jsonfile_1=jsonfile;const u$8=universalify.fromCallback;var jsonfile$1={readJson:u$8(jsonfile_1.readFile),readJsonSync:jsonfile_1.readFileSync,writeJson:u$8(jsonfile_1.writeFile),writeJsonSync:jsonfile_1.writeFileSync};const pathExists$6=pathExists_1.pathExists;function outputJson(t,e,r,n){"function"==typeof r&&(n=r,r={});const i=path$1.dirname(t);pathExists$6(i,(s,o)=>s?n(s):o?jsonfile$1.writeJson(t,e,r,n):void mkdirs_1$1.mkdirs(i,i=>{if(i)return n(i);jsonfile$1.writeJson(t,e,r,n)}))}var outputJson_1=outputJson;function outputJsonSync(t,e,r){const n=path$1.dirname(t);gracefulFs.existsSync(n)||mkdirs_1$1.mkdirsSync(n),jsonfile$1.writeJsonSync(t,e,r)}var outputJsonSync_1=outputJsonSync;const u$9=universalify.fromCallback;jsonfile$1.outputJson=u$9(outputJson_1),jsonfile$1.outputJsonSync=outputJsonSync_1,jsonfile$1.outputJSON=jsonfile$1.outputJson,jsonfile$1.outputJSONSync=jsonfile$1.outputJsonSync,jsonfile$1.writeJSON=jsonfile$1.writeJson,jsonfile$1.writeJSONSync=jsonfile$1.writeJsonSync,jsonfile$1.readJSON=jsonfile$1.readJson,jsonfile$1.readJSONSync=jsonfile$1.readJsonSync;var json=jsonfile$1;const copySync$2=copySync$1.copySync,removeSync=remove.removeSync,mkdirpSync$1=mkdirs_1$1.mkdirsSync;function moveSync(t,e,r){const n=(r=r||{}).overwrite||r.clobber||!1;if(t=path$1.resolve(t),e=path$1.resolve(e),t===e)return gracefulFs.accessSync(t);if(isSrcSubdir$2(t,e))throw new Error(`Cannot move '${t}' into itself '${e}'.`);mkdirpSync$1(path$1.dirname(e)),function(){if(n)try{gracefulFs.renameSync(t,e)}catch(i){if("ENOTEMPTY"===i.code||"EEXIST"===i.code||"EPERM"===i.code)return removeSync(e),r.overwrite=!1,moveSync(t,e,r);if("EXDEV"!==i.code)throw i;return moveSyncAcrossDevice(t,e,n)}else try{gracefulFs.linkSync(t,e),gracefulFs.unlinkSync(t)}catch(r){if("EXDEV"===r.code||"EISDIR"===r.code||"EPERM"===r.code||"ENOTSUP"===r.code)return moveSyncAcrossDevice(t,e,n);throw r}}()}function moveSyncAcrossDevice(t,e,r){return gracefulFs.statSync(t).isDirectory()?moveDirSyncAcrossDevice(t,e,r):moveFileSyncAcrossDevice(t,e,r)}function moveFileSyncAcrossDevice(t,e,r){const n=buffer(65536),i=r?"w":"wx",s=gracefulFs.openSync(t,"r"),o=gracefulFs.fstatSync(s),c=gracefulFs.openSync(e,i,o.mode);let a=0;for(;a<o.size;){const t=gracefulFs.readSync(s,n,0,65536,a);gracefulFs.writeSync(c,n,0,t),a+=t}return gracefulFs.closeSync(s),gracefulFs.closeSync(c),gracefulFs.unlinkSync(t)}function moveDirSyncAcrossDevice(t,e,r){const n={overwrite:!1};function i(){return copySync$2(t,e,n),removeSync(t)}r?(removeSync(e),i()):i()}function isSrcSubdir$2(t,e){try{return gracefulFs.statSync(t).isDirectory()&&t!==e&&e.indexOf(t)>-1&&e.split(path$1.dirname(t)+path$1.sep)[1].split(path$1.sep)[0]===path$1.basename(t)}catch(t){return!1}}var moveSync_1={moveSync:moveSync};const u$a=universalify.fromCallback,copy$2=copy$1.copy,remove$1=remove.remove,mkdirp$1=mkdirs_1$1.mkdirp,pathExists$7=pathExists_1.pathExists;function move(t,e,r,n){"function"==typeof r&&(n=r,r={});const i=r.overwrite||r.clobber||!1;if(t=path$1.resolve(t),e=path$1.resolve(e),t===e)return gracefulFs.access(t,n);gracefulFs.stat(t,(r,s)=>r?n(r):s.isDirectory()&&isSrcSubdir$3(t,e)?n(new Error(`Cannot move '${t}' to a subdirectory of itself, '${e}'.`)):void mkdirp$1(path$1.dirname(e),r=>r?n(r):doRename(t,e,i,n)))}function doRename(t,e,r,n){if(r)return remove$1(e,i=>i?n(i):rename(t,e,r,n));pathExists$7(e,(i,s)=>i?n(i):s?n(new Error("dest already exists.")):rename(t,e,r,n))}function rename(t,e,r,n){gracefulFs.rename(t,e,i=>i?"EXDEV"!==i.code?n(i):moveAcrossDevice(t,e,r,n):n())}function moveAcrossDevice(t,e,r,n){copy$2(t,e,{overwrite:r,errorOnExist:!0},e=>e?n(e):remove$1(t,n))}function isSrcSubdir$3(t,e){const r=t.split(path$1.sep),n=e.split(path$1.sep);return r.reduce((t,e,r)=>t&&n[r]===e,!0)}var move_1={move:u$a(move)};const u$b=universalify.fromCallback,pathExists$8=pathExists_1.pathExists;function outputFile(t,e,r,n){"function"==typeof r&&(n=r,r="utf8");const i=path$1.dirname(t);pathExists$8(i,(s,o)=>s?n(s):o?gracefulFs.writeFile(t,e,r,n):void mkdirs_1$1.mkdirs(i,i=>{if(i)return n(i);gracefulFs.writeFile(t,e,r,n)}))}function outputFileSync(t,...e){const r=path$1.dirname(t);if(gracefulFs.existsSync(r))return gracefulFs.writeFileSync(t,...e);mkdirs_1$1.mkdirsSync(r),gracefulFs.writeFileSync(t,...e)}var output={outputFile:u$b(outputFile),outputFileSync:outputFileSync},lib=createCommonjsModule(function(t){t.exports=Object.assign({},fs_1,copySync$1,copy$1,empty,ensure,json,mkdirs_1$1,moveSync_1,move_1,output,pathExists_1,remove),Object.getOwnPropertyDescriptor(fs,"promises")&&Object.defineProperty(t.exports,"promises",{get:()=>fs.promises})}),isWindows$1="win32"===process.platform,DEBUG=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function rethrow(){var t;if(DEBUG){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}function maybeCallback(t){return"function"==typeof t?t:rethrow()}var normalize=path$1.normalize;if(isWindows$1)var nextPartRe=/(.*?)(?:[\/\\]+|$)/g;else nextPartRe=/(.*?)(?:[\/]+|$)/g;if(isWindows$1)var splitRootRe=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else splitRootRe=/^[\/]*/;var realpathSync=function(t,e){if(t=path$1.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var r,n,i,s,o=t,c={},a={};function l(){var e=splitRootRe.exec(t);r=e[0].length,n=e[0],i=e[0],s="",isWindows$1&&!a[i]&&(fs.lstatSync(i),a[i]=!0)}for(l();r<t.length;){nextPartRe.lastIndex=r;var u=nextPartRe.exec(t);if(s=n,n+=u[0],i=s+u[1],r=nextPartRe.lastIndex,!(a[i]||e&&e[i]===i)){var f;if(e&&Object.prototype.hasOwnProperty.call(e,i))f=e[i];else{var h=fs.lstatSync(i);if(!h.isSymbolicLink()){a[i]=!0,e&&(e[i]=i);continue}var p=null;if(!isWindows$1){var m=h.dev.toString(32)+":"+h.ino.toString(32);c.hasOwnProperty(m)&&(p=c[m])}null===p&&(fs.statSync(i),p=fs.readlinkSync(i)),f=path$1.resolve(s,p),e&&(e[i]=f),isWindows$1||(c[m]=p)}t=path$1.resolve(f,t.slice(r)),l()}}return e&&(e[o]=t),t},realpath=function(t,e,r){if("function"!=typeof r&&(r=maybeCallback(e),e=null),t=path$1.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var n,i,s,o,c=t,a={},l={};function u(){var e=splitRootRe.exec(t);n=e[0].length,i=e[0],s=e[0],o="",isWindows$1&&!l[s]?fs.lstat(s,function(t){if(t)return r(t);l[s]=!0,f()}):process.nextTick(f)}function f(){if(n>=t.length)return e&&(e[c]=t),r(null,t);nextPartRe.lastIndex=n;var a=nextPartRe.exec(t);return o=i,i+=a[0],s=o+a[1],n=nextPartRe.lastIndex,l[s]||e&&e[s]===s?process.nextTick(f):e&&Object.prototype.hasOwnProperty.call(e,s)?m(e[s]):fs.lstat(s,h)}function h(t,n){if(t)return r(t);if(!n.isSymbolicLink())return l[s]=!0,e&&(e[s]=s),process.nextTick(f);if(!isWindows$1){var i=n.dev.toString(32)+":"+n.ino.toString(32);if(a.hasOwnProperty(i))return p(null,a[i],s)}fs.stat(s,function(t){if(t)return r(t);fs.readlink(s,function(t,e){isWindows$1||(a[i]=e),p(t,e)})})}function p(t,n,i){if(t)return r(t);var s=path$1.resolve(o,n);e&&(e[i]=s),m(s)}function m(e){t=path$1.resolve(e,t.slice(n)),u()}u()},old={realpathSync:realpathSync,realpath:realpath},fs_realpath=realpath$1;realpath$1.realpath=realpath$1,realpath$1.sync=realpathSync$1,realpath$1.realpathSync=realpathSync$1,realpath$1.monkeypatch=monkeypatch,realpath$1.unmonkeypatch=unmonkeypatch;var origRealpath=fs.realpath,origRealpathSync=fs.realpathSync,version=process.version,ok=/^v[0-5]\./.test(version);function newError(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function realpath$1(t,e,r){if(ok)return origRealpath(t,e,r);"function"==typeof e&&(r=e,e=null),origRealpath(t,e,function(n,i){newError(n)?old.realpath(t,e,r):r(n,i)})}function realpathSync$1(t,e){if(ok)return origRealpathSync(t,e);try{return origRealpathSync(t,e)}catch(r){if(newError(r))return old.realpathSync(t,e);throw r}}function monkeypatch(){fs.realpath=realpath$1,fs.realpathSync=realpathSync$1}function unmonkeypatch(){fs.realpath=origRealpath,fs.realpathSync=origRealpathSync}var concatMap=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n],n);isArray(i)?r.push.apply(r,i):r.push(i)}return r},isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},balancedMatch=balanced;function balanced(t,e,r){t instanceof RegExp&&(t=maybeMatch(t,r)),e instanceof RegExp&&(e=maybeMatch(e,r));var n=range(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function maybeMatch(t,e){var r=e.match(t);return r?r[0]:null}function range(t,e,r){var n,i,s,o,c,a=r.indexOf(t),l=r.indexOf(e,a+1),u=a;if(a>=0&&l>0){for(n=[],s=r.length;u>=0&&!c;)u==a?(n.push(u),a=r.indexOf(t,u+1)):1==n.length?c=[n.pop(),l]:((i=n.pop())<s&&(s=i,o=l),l=r.indexOf(e,u+1)),u=a<l&&a>=0?a:l;n.length&&(c=[s,o])}return c}balanced.range=range;var braceExpansion=expandTop,escSlash="\0SLASH"+Math.random()+"\0",escOpen="\0OPEN"+Math.random()+"\0",escClose="\0CLOSE"+Math.random()+"\0",escComma="\0COMMA"+Math.random()+"\0",escPeriod="\0PERIOD"+Math.random()+"\0";function numeric(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function escapeBraces(t){return t.split("\\\\").join(escSlash).split("\\{").join(escOpen).split("\\}").join(escClose).split("\\,").join(escComma).split("\\.").join(escPeriod)}function unescapeBraces(t){return t.split(escSlash).join("\\").split(escOpen).join("{").split(escClose).join("}").split(escComma).join(",").split(escPeriod).join(".")}function parseCommaParts(t){if(!t)return[""];var e=[],r=balancedMatch("{","}",t);if(!r)return t.split(",");var n=r.pre,i=r.body,s=r.post,o=n.split(",");o[o.length-1]+="{"+i+"}";var c=parseCommaParts(s);return s.length&&(o[o.length-1]+=c.shift(),o.push.apply(o,c)),e.push.apply(e,o),e}function expandTop(t){return t?("{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2)),expand(escapeBraces(t),!0).map(unescapeBraces)):[]}function embrace(t){return"{"+t+"}"}function isPadded(t){return/^-?0\d/.test(t)}function lte(t,e){return t<=e}function gte(t,e){return t>=e}function expand(t,e){var r=[],n=balancedMatch("{","}",t);if(!n||/\$$/.test(n.pre))return[t];var i,s=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),c=s||o,a=n.body.indexOf(",")>=0;if(!c&&!a)return n.post.match(/,.*\}/)?expand(t=n.pre+"{"+n.body+escClose+n.post):[t];if(c)i=n.body.split(/\.\./);else if(1===(i=parseCommaParts(n.body)).length&&1===(i=expand(i[0],!1).map(embrace)).length)return(f=n.post.length?expand(n.post,!1):[""]).map(function(t){return n.pre+i[0]+t});var l,u=n.pre,f=n.post.length?expand(n.post,!1):[""];if(c){var h=numeric(i[0]),p=numeric(i[1]),m=Math.max(i[0].length,i[1].length),y=3==i.length?Math.abs(numeric(i[2])):1,d=lte;p<h&&(y*=-1,d=gte);var g=i.some(isPadded);l=[];for(var S=h;d(S,p);S+=y){var v;if(o)"\\"===(v=String.fromCharCode(S))&&(v="");else if(v=String(S),g){var b=m-v.length;if(b>0){var w=new Array(b+1).join("0");v=S<0?"-"+w+v.slice(1):w+v}}l.push(v)}}else l=concatMap(i,function(t){return expand(t,!1)});for(var k=0;k<l.length;k++)for(var E=0;E<f.length;E++){var $=u+l[k]+f[E];(!e||c||$)&&r.push($)}return r}var minimatch_1=minimatch;minimatch.Minimatch=Minimatch;var path={sep:"/"};try{path=path$1}catch(t){}var GLOBSTAR=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={},plTypes={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},qmark="[^/]",star=qmark+"*?",twoStarDot="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",twoStarNoDot="(?:(?!(?:\\/|^)\\.).)*?",reSpecials=charSet("().*{}+?[]^$\\!");function charSet(t){return t.split("").reduce(function(t,e){return t[e]=!0,t},{})}var slashSplit=/\/+/;function filter(t,e){return e=e||{},function(r,n,i){return minimatch(r,t,e)}}function ext(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function minimatch(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new Minimatch(e,r).match(t))}function Minimatch(t,e){if(!(this instanceof Minimatch))return new Minimatch(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==path.sep&&(t=t.split(path.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function make(){if(!this._made){var t=this.pattern,e=this.options;if(e.nocomment||"#"!==t.charAt(0))if(t){this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error),this.debug(this.pattern,r),r=this.globParts=r.map(function(t){return t.split(slashSplit)}),this.debug(this.pattern,r),r=r.map(function(t,e,r){return t.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(t){return-1===t.indexOf(!1)}),this.debug(this.pattern,r),this.set=r}else this.empty=!0;else this.comment=!0}}function parseNegate(){var t=this.pattern,e=!1,r=0;if(!this.options.nonegate){for(var n=0,i=t.length;n<i&&"!"===t.charAt(n);n++)e=!e,r++;r&&(this.pattern=t.substr(r)),this.negate=e}}function braceExpand(t,e){if(e||(e=this instanceof Minimatch?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:braceExpansion(t)}minimatch.filter=filter,minimatch.defaults=function(t){if(!t||!Object.keys(t).length)return minimatch;var e=minimatch,r=function(r,n,i){return e.minimatch(r,n,ext(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,ext(t,n))},r},Minimatch.defaults=function(t){return t&&Object.keys(t).length?minimatch.defaults(t).Minimatch:Minimatch},Minimatch.prototype.debug=function(){},Minimatch.prototype.make=make,Minimatch.prototype.parseNegate=parseNegate,minimatch.braceExpand=function(t,e){return braceExpand(t,e)},Minimatch.prototype.braceExpand=braceExpand,Minimatch.prototype.parse=parse;var SUBPARSE={};function parse(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===t)return GLOBSTAR;if(""===t)return"";var n,i="",s=!!r.nocase,o=!1,c=[],a=[],l=!1,u=-1,f=-1,h="."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",p=this;function m(){if(n){switch(n){case"*":i+=star,s=!0;break;case"?":i+=qmark,s=!0;break;default:i+="\\"+n}p.debug("clearStateChar %j %j",n,i),n=!1}}for(var y,d=0,g=t.length;d<g&&(y=t.charAt(d));d++)if(this.debug("%s\t%s %s %j",t,d,i,y),o&&reSpecials[y])i+="\\"+y,o=!1;else switch(y){case"/":return!1;case"\\":m(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,d,i,y),l){this.debug("  in class"),"!"===y&&d===f+1&&(y="^"),i+=y;continue}p.debug("call clearStateChar %j",n),m(),n=y,r.noext&&m();continue;case"(":if(l){i+="(";continue}if(!n){i+="\\(";continue}c.push({type:n,start:d-1,reStart:i.length,open:plTypes[n].open,close:plTypes[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(l||!c.length){i+="\\)";continue}m(),s=!0;var S=c.pop();i+=S.close,"!"===S.type&&a.push(S),S.reEnd=i.length;continue;case"|":if(l||!c.length||o){i+="\\|",o=!1;continue}m(),i+="|";continue;case"[":if(m(),l){i+="\\"+y;continue}l=!0,f=d,u=i.length,i+=y;continue;case"]":if(d===f+1||!l){i+="\\"+y,o=!1;continue}if(l)var v,b=t.substring(f+1,d);s=!0,l=!1,i+=y;continue;default:m(),o?o=!1:!reSpecials[y]||"^"===y&&l||(i+="\\"),i+=y}for(l&&(b=t.substr(f+1),v=this.parse(b,SUBPARSE),i=i.substr(0,u)+"\\["+v[0],s=s||v[1]),S=c.pop();S;S=c.pop()){var w=i.slice(S.reStart+S.open.length);this.debug("setting tail",i,S),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(t,e,r){return r||(r="\\"),e+e+r+"|"}),this.debug("tail=%j\n   %s",w,w,S,i);var k="*"===S.type?star:"?"===S.type?qmark:"\\"+S.type;s=!0,i=i.slice(0,S.reStart)+k+"\\("+w}m(),o&&(i+="\\\\");var E=!1;switch(i.charAt(0)){case".":case"[":case"(":E=!0}for(var $=a.length-1;$>-1;$--){var _=a[$],F=i.slice(0,_.reStart),x=i.slice(_.reStart,_.reEnd-8),O=i.slice(_.reEnd-8,_.reEnd),A=i.slice(_.reEnd);O+=A;var j=F.split("(").length-1,D=A;for(d=0;d<j;d++)D=D.replace(/\)[+*?]?/,"");var P="";""===(A=D)&&e!==SUBPARSE&&(P="$"),i=F+x+A+P+O}if(""!==i&&s&&(i="(?=.)"+i),E&&(i=h+i),e===SUBPARSE)return[i,s];if(!s)return globUnescape(t);var I=r.nocase?"i":"";try{var R=new RegExp("^"+i+"$",I)}catch(t){return new RegExp("$.")}return R._glob=t,R._src=i,R}function makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?star:e.dot?twoStarDot:twoStarNoDot,n=e.nocase?"i":"",i=t.map(function(t){return t.map(function(t){return t===GLOBSTAR?r:"string"==typeof t?regExpEscape(t):t._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(t){this.regexp=!1}return this.regexp}function match(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==path.sep&&(t=t.split(path.sep).join("/")),t=t.split(slashSplit),this.debug(this.pattern,"split",t);var n,i,s=this.set;for(this.debug(this.pattern,"set",s),i=t.length-1;i>=0&&!(n=t[i]);i--);for(i=0;i<s.length;i++){var o=s[i],c=t;if(r.matchBase&&1===o.length&&(c=[n]),this.matchOne(c,o,e))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}function globUnescape(t){return t.replace(/\\(.)/g,"$1")}function regExpEscape(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}minimatch.makeRe=function(t,e){return new Minimatch(t,e||{}).makeRe()},Minimatch.prototype.makeRe=makeRe,minimatch.match=function(t,e,r){var n=new Minimatch(e,r=r||{});return t=t.filter(function(t){return n.match(t)}),n.options.nonull&&!t.length&&t.push(e),t},Minimatch.prototype.match=match,Minimatch.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,s=0,o=t.length,c=e.length;i<o&&s<c;i++,s++){this.debug("matchOne loop");var a,l=e[s],u=t[i];if(this.debug(e,l,u),!1===l)return!1;if(l===GLOBSTAR){this.debug("GLOBSTAR",[e,l,u]);var f=i,h=s+1;if(h===c){for(this.debug("** at the end");i<o;i++)if("."===t[i]||".."===t[i]||!n.dot&&"."===t[i].charAt(0))return!1;return!0}for(;f<o;){var p=t[f];if(this.debug("\nglobstar while",t,f,e,h,p),this.matchOne(t.slice(f),e.slice(h),r))return this.debug("globstar found match!",f,o,p),!0;if("."===p||".."===p||!n.dot&&"."===p.charAt(0)){this.debug("dot detected!",t,f,e,h);break}this.debug("globstar swallow a segment, and continue"),f++}return!(!r||(this.debug("\n>>> no match, partial?",t,f,e,h),f!==o))}if("string"==typeof l?(a=n.nocase?u.toLowerCase()===l.toLowerCase():u===l,this.debug("string match",l,u,a)):(a=u.match(l),this.debug("pattern match",l,u,a)),!a)return!1}if(i===o&&s===c)return!0;if(i===o)return r;if(s===c)return i===o-1&&""===t[i];throw new Error("wtf?")};var inherits_browser=createCommonjsModule(function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}),inherits=createCommonjsModule(function(t){try{var e=util;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=inherits_browser}});function posix(t){return"/"===t.charAt(0)}function win32$1(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),r=e[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(e[2]||n)}var pathIsAbsolute="win32"===process.platform?win32$1:posix,posix_1=posix,win32_1=win32$1;pathIsAbsolute.posix=posix_1,pathIsAbsolute.win32=win32_1;var alphasort_1=alphasort,alphasorti_1=alphasorti,setopts_1=setopts,ownProp_1=ownProp,makeAbs_1=makeAbs,finish_1=finish,mark_1=mark,isIgnored_1=isIgnored,childrenIgnored_1=childrenIgnored;function ownProp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Minimatch$1=minimatch_1.Minimatch;function alphasorti(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function alphasort(t,e){return t.localeCompare(e)}function setupIgnores(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(ignoreMap))}function ignoreMap(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new Minimatch$1(r,{dot:!0})}return{matcher:new Minimatch$1(t,{dot:!0}),gmatcher:e}}function setopts(t,e,r){if(r||(r={}),r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),setupIgnores(t,r),t.changedCwd=!1;var n=process.cwd();ownProp(r,"cwd")?(t.cwd=path$1.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=n,t.root=r.root||path$1.resolve(t.cwd,"/"),t.root=path$1.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=pathIsAbsolute(t.cwd)?t.cwd:makeAbs(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new Minimatch$1(e,r),t.options=t.minimatch.options}function finish(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var s=t.matches[n];if(s&&0!==Object.keys(s).length){var o=Object.keys(s);e?r.push.apply(r,o):o.forEach(function(t){r[t]=!0})}else if(t.nonull){var c=t.minimatch.globSet[n];e?r.push(c):r[c]=!0}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(t.nocase?alphasorti:alphasort)),t.mark){for(n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[makeAbs(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}t.ignore.length&&(r=r.filter(function(e){return!isIgnored(t,e)})),t.found=r}function mark(t,e){var r=makeAbs(t,e),n=t.cache[r],i=e;if(n){var s="DIR"===n||Array.isArray(n),o="/"===e.slice(-1);if(s&&!o?i+="/":!s&&o&&(i=i.slice(0,-1)),i!==e){var c=makeAbs(t,i);t.statCache[c]=t.statCache[r],t.cache[c]=t.cache[r]}}return i}function makeAbs(t,e){var r=e;return r="/"===e.charAt(0)?path$1.join(t.root,e):pathIsAbsolute(e)||""===e?e:t.changedCwd?path$1.resolve(t.cwd,e):path$1.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function isIgnored(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))})}function childrenIgnored(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return!(!t.gmatcher||!t.gmatcher.match(e))})}var common={alphasort:alphasort_1,alphasorti:alphasorti_1,setopts:setopts_1,ownProp:ownProp_1,makeAbs:makeAbs_1,finish:finish_1,mark:mark_1,isIgnored:isIgnored_1,childrenIgnored:childrenIgnored_1},sync=globSync;globSync.GlobSync=GlobSync;var setopts$1=common.setopts,ownProp$1=common.ownProp,childrenIgnored$1=common.childrenIgnored,isIgnored$1=common.isIgnored;function globSync(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new GlobSync(t,e).found}function GlobSync(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof GlobSync))return new GlobSync(t,e);if(setopts$1(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}GlobSync.prototype._finish=function(){if(assert(this instanceof GlobSync),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i),n[fs_realpath.realpathSync(i,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;n[t._makeAbs(i)]=!0}})}common.finish(this)},GlobSync.prototype._process=function(t,e,r){assert(this instanceof GlobSync);for(var n,i=0;"string"==typeof t[i];)i++;switch(i){case t.length:return void this._processSimple(t.join("/"),e);case 0:n=null;break;default:n=t.slice(0,i).join("/")}var s,o=t.slice(i);null===n?s=".":pathIsAbsolute(n)||pathIsAbsolute(t.join("/"))?(n&&pathIsAbsolute(n)||(n="/"+n),s=n):s=n;var c=this._makeAbs(s);childrenIgnored$1(this,s)||(o[0]===minimatch_1.GLOBSTAR?this._processGlobStar(n,s,c,o,e,r):this._processReaddir(n,s,c,o,e,r))},GlobSync.prototype._processReaddir=function(t,e,r,n,i,s){var o=this._readdir(r,s);if(o){for(var c=n[0],a=!!this.minimatch.negate,l=c._glob,u=this.dot||"."===l.charAt(0),f=[],h=0;h<o.length;h++){if("."!==(y=o[h]).charAt(0)||u)(a&&!t?!y.match(c):y.match(c))&&f.push(y)}var p=f.length;if(0!==p)if(1!==n.length||this.mark||this.stat){n.shift();for(h=0;h<p;h++){var m;y=f[h];m=t?[t,y]:[y],this._process(m.concat(n),i,s)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var h=0;h<p;h++){var y=f[h];t&&(y="/"!==t.slice(-1)?t+"/"+y:t+y),"/"!==y.charAt(0)||this.nomount||(y=path$1.join(this.root,y)),this._emitMatch(i,y)}}}},GlobSync.prototype._emitMatch=function(t,e){if(!isIgnored$1(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},GlobSync.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=fs.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[t]=n,n||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},GlobSync.prototype._readdir=function(t,e){if(e&&!ownProp$1(this.symlinks,t))return this._readdirInGlobStar(t);if(ownProp$1(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,fs.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},GlobSync.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},GlobSync.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},GlobSync.prototype._processGlobStar=function(t,e,r,n,i,s){var o=this._readdir(r,s);if(o){var c=n.slice(1),a=t?[t]:[],l=a.concat(c);this._process(l,i,!1);var u=o.length;if(!this.symlinks[r]||!s)for(var f=0;f<u;f++){if("."!==o[f].charAt(0)||this.dot){var h=a.concat(o[f],c);this._process(h,i,!0);var p=a.concat(o[f],n);this._process(p,i,!0)}}}},GlobSync.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&pathIsAbsolute(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=path$1.join(this.root,t):(t=path$1.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},GlobSync.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&ownProp$1(this.cache,e)){var n=this.cache[e];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var i=this.statCache[e];if(!i){var s;try{s=fs.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(s&&s.isSymbolicLink())try{i=fs.statSync(e)}catch(t){i=s}else i=s}this.statCache[e]=i;n=!0;return i&&(n=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||n,(!r||"FILE"!==n)&&n},GlobSync.prototype._mark=function(t){return common.mark(this,t)},GlobSync.prototype._makeAbs=function(t){return common.makeAbs(this,t)};var wrappy_1=wrappy;function wrappy(t,e){if(t&&e)return wrappy(t)(e);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){r[e]=t[e]}),r;function r(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(t){n[t]=i[t]}),n}}var once_1=wrappy_1(once),strict=wrappy_1(onceStrict);function once(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function onceStrict(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})}),once_1.strict=strict;var reqs=Object.create(null),inflight_1=wrappy_1(inflight);function inflight(t,e){return reqs[t]?(reqs[t].push(e),null):(reqs[t]=[e],makeres(t))}function makeres(t){return once_1(function e(){var r=reqs[t],n=r.length,i=slice(arguments);try{for(var s=0;s<n;s++)r[s].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,i)})):delete reqs[t]}})}function slice(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}var glob_1=glob,EE=events.EventEmitter,setopts$2=common.setopts,ownProp$2=common.ownProp,childrenIgnored$2=common.childrenIgnored,isIgnored$2=common.isIgnored;function glob(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return sync(t,e)}return new Glob(t,e,r)}glob.sync=sync;var GlobSync$1=glob.GlobSync=sync.GlobSync;function extend(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}function Glob(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new GlobSync$1(t,e)}if(!(this instanceof Glob))return new Glob(t,e,r);setopts$2(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=once_1(r),this.on("error",r),this.on("end",function(t){r(null,t)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return c();for(var s=!0,o=0;o<n;o++)this._process(this.minimatch.set[o],o,!1,c);function c(){--i._processing,i._processing<=0&&(s?process.nextTick(function(){i._finish()}):i._finish())}s=!1}function readdirCb(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}glob.glob=glob,glob.hasMagic=function(t,e){var r=extend({},e);r.noprocess=!0;var n=new Glob(t,r).minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},glob.Glob=Glob,inherits(Glob,EE),Glob.prototype._finish=function(){if(assert(this instanceof Glob),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();common.finish(this),this.emit("end",this.found)}},Glob.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--t&&e._finish()}},Glob.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),i=this,s=n.length;if(0===s)return e();var o=this.matches[t]=Object.create(null);n.forEach(function(r,n){r=i._makeAbs(r),fs_realpath.realpath(r,i.realpathCache,function(n,c){n?"stat"===n.syscall?o[r]=!0:i.emit("error",n):o[c]=!0,0==--s&&(i.matches[t]=o,e())})})},Glob.prototype._mark=function(t){return common.mark(this,t)},Glob.prototype._makeAbs=function(t){return common.makeAbs(this,t)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Glob.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},Glob.prototype._process=function(t,e,r,n){if(assert(this instanceof Glob),assert("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,r,n]);else{for(var i,s=0;"string"==typeof t[s];)s++;switch(s){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:i=null;break;default:i=t.slice(0,s).join("/")}var o,c=t.slice(s);null===i?o=".":pathIsAbsolute(i)||pathIsAbsolute(t.join("/"))?(i&&pathIsAbsolute(i)||(i="/"+i),o=i):o=i;var a=this._makeAbs(o);if(childrenIgnored$2(this,o))return n();c[0]===minimatch_1.GLOBSTAR?this._processGlobStar(i,o,a,c,e,r,n):this._processReaddir(i,o,a,c,e,r,n)}},Glob.prototype._processReaddir=function(t,e,r,n,i,s,o){var c=this;this._readdir(r,s,function(a,l){return c._processReaddir2(t,e,r,n,i,s,l,o)})},Glob.prototype._processReaddir2=function(t,e,r,n,i,s,o,c){if(!o)return c();for(var a=n[0],l=!!this.minimatch.negate,u=a._glob,f=this.dot||"."===u.charAt(0),h=[],p=0;p<o.length;p++){if("."!==(y=o[p]).charAt(0)||f)(l&&!t?!y.match(a):y.match(a))&&h.push(y)}var m=h.length;if(0===m)return c();if(1===n.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(p=0;p<m;p++){var y=h[p];t&&(y="/"!==t?t+"/"+y:t+y),"/"!==y.charAt(0)||this.nomount||(y=path$1.join(this.root,y)),this._emitMatch(i,y)}return c()}n.shift();for(p=0;p<m;p++){y=h[p];t&&(y="/"!==t?t+"/"+y:t+y),this._process([y].concat(n),i,s,c)}c()},Glob.prototype._emitMatch=function(t,e){if(!this.aborted&&!isIgnored$2(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=pathIsAbsolute(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}},Glob.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var r=this,n=inflight_1("lstat\0"+t,function(n,i){if(n&&"ENOENT"===n.code)return e();var s=i&&i.isSymbolicLink();r.symlinks[t]=s,s||!i||i.isDirectory()?r._readdir(t,!1,e):(r.cache[t]="FILE",e())});n&&fs.lstat(t,n)}},Glob.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=inflight_1("readdir\0"+t+"\0"+e,r))){if(e&&!ownProp$2(this.symlinks,t))return this._readdirInGlobStar(t,r);if(ownProp$2(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}fs.readdir(t,readdirCb(this,t,r))}},Glob.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];i="/"===t?t+i:t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}},Glob.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},Glob.prototype._processGlobStar=function(t,e,r,n,i,s,o){var c=this;this._readdir(r,s,function(a,l){c._processGlobStar2(t,e,r,n,i,s,l,o)})},Glob.prototype._processGlobStar2=function(t,e,r,n,i,s,o,c){if(!o)return c();var a=n.slice(1),l=t?[t]:[],u=l.concat(a);this._process(u,i,!1,c);var f=this.symlinks[r],h=o.length;if(f&&s)return c();for(var p=0;p<h;p++){if("."!==o[p].charAt(0)||this.dot){var m=l.concat(o[p],a);this._process(m,i,!0,c);var y=l.concat(o[p],n);this._process(y,i,!0,c)}}c()},Glob.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(i,s){n._processSimple2(t,e,i,s,r)})},Glob.prototype._processSimple2=function(t,e,r,n,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return i();if(t&&pathIsAbsolute(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=path$1.join(this.root,t):(t=path$1.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()},Glob.prototype._stat=function(t,e){var r=this._makeAbs(t),n="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&ownProp$2(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return e(null,i);if(n&&"FILE"===i)return e()}var s=this.statCache[r];if(void 0!==s){if(!1===s)return e(null,s);var o=s.isDirectory()?"DIR":"FILE";return n&&"FILE"===o?e():e(null,o,s)}var c=this,a=inflight_1("stat\0"+r,function(n,i){if(i&&i.isSymbolicLink())return fs.stat(r,function(n,s){n?c._stat2(t,r,null,i,e):c._stat2(t,r,n,s,e)});c._stat2(t,r,n,i,e)});a&&fs.lstat(r,a)},Glob.prototype._stat2=function(t,e,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,i();var s="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||o,s&&"FILE"===o?i():i(null,o,n)};const default_length=16,create_random_id=(t=16)=>{(t<=0||"number"!=typeof t)&&(t=16);let e="";for(;t--;)e+=Math.floor(16*Math.random()+1).toString(16).toUpperCase();return e};var random={create_random_id:create_random_id},random_1=random.create_random_id;const default_options={path:"./data/",spaces:2,random:()=>random_1(5),sync:{create:!0,read:!1,update:!0,delete:!0}};class CardBox{constructor(t=default_options){this._options=Object.assign({},default_options,t,{sync:Object.assign({},default_options.sync,t.sync)},{format:Object.assign({},default_options.format,t.format)}),this._options.path+=this._options.path.endsWith("/")?"":"/",this._cards={}}_card_path(t){return`${this._options.path}${t}.json`}async init(){return new Promise(t=>{lib.ensureDir(this._options.path,e=>{e&&console.error(e),t()})})}async load(){return await this.init(),new Promise(t=>{glob_1(`${this._options.path}**/*.json`,{},(e,r)=>{e&&console.error(e),r.forEach(t=>{const e=lib.readJsonSync(t,t=>{t&&console.error(t)});this._cards[e.id]=e}),t(!0)})})}async create(t={},e=this._options.sync.create){return t.id||(t.id=this._options.random()),new Promise(r=>{const n=this._card_path(t.id);lib.writeJson(n,t,{spaces:this._options.spaces},n=>{n&&console.error(n),!0===e&&setTimeout(()=>r(t))}),this._cards[t.id]=t,!1===e&&setTimeout(()=>r(t))})}async read(t){return new Promise(e=>{t||e(Object.values(this._cards)),e(this._cards[t])})}async update(t,e=this._options.sync.update){return new Promise(async r=>{r(await this.create(t,e))})}async delete(t,e=this._options.sync.update){return new Promise(r=>{t&&this._cards[t]||r(!1);const n=this._card_path(t);lib.remove(n,t=>{t&&console.error(t),!0===e&&r(!0)}),delete this._cards[t],!1===e&&r(!0)})}}module.exports=CardBox;
