import t from"fs";import e from"constants";import r from"stream";import n from"util";import i from"assert";import o from"path";import s from"os";import c from"events";function a(t,e){return t(e={exports:{}},e.exports),e.exports}var u=function(t){return Object.defineProperty(function(){if("function"!=typeof arguments[arguments.length-1])return new Promise((e,r)=>{arguments[arguments.length]=((t,n)=>{if(t)return r(t);e(n)}),arguments.length++,t.apply(this,arguments)});t.apply(this,arguments)},"name",{value:t.name})},f=function(t){return Object.defineProperty(function(){const e=arguments[arguments.length-1];if("function"!=typeof e)return t.apply(this,arguments);t.apply(this,arguments).then(t=>e(null,t),e)},"name",{value:t.name})},h=process.cwd,l=null,p=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return l||(l=h.call(process)),l};try{process.cwd()}catch(t){}var d=process.chdir;process.chdir=function(t){l=null,d.call(process,t)};var y=function(t){e.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(t){t.lchmod=function(r,n,i){t.open(r,e.O_WRONLY|e.O_SYMLINK,n,function(e,r){e?i&&i(e):t.fchmod(r,n,function(e){t.close(r,function(t){i&&i(e||t)})})})},t.lchmodSync=function(r,n){var i,o=t.openSync(r,e.O_WRONLY|e.O_SYMLINK,n),s=!0;try{i=t.fchmodSync(o,n),s=!1}finally{if(s)try{t.closeSync(o)}catch(t){}else t.closeSync(o)}return i}}(t);t.lutimes||function(t){e.hasOwnProperty("O_SYMLINK")?(t.lutimes=function(r,n,i,o){t.open(r,e.O_SYMLINK,function(e,r){e?o&&o(e):t.futimes(r,n,i,function(e){t.close(r,function(t){o&&o(e||t)})})})},t.lutimesSync=function(r,n,i){var o,s=t.openSync(r,e.O_SYMLINK),c=!0;try{o=t.futimesSync(s,n,i),c=!1}finally{if(c)try{t.closeSync(s)}catch(t){}else t.closeSync(s)}return o}):(t.lutimes=function(t,e,r,n){n&&process.nextTick(n)},t.lutimesSync=function(){})}(t);t.chown=o(t.chown),t.fchown=o(t.fchown),t.lchown=o(t.lchown),t.chmod=n(t.chmod),t.fchmod=n(t.fchmod),t.lchmod=n(t.lchmod),t.chownSync=s(t.chownSync),t.fchownSync=s(t.fchownSync),t.lchownSync=s(t.lchownSync),t.chmodSync=i(t.chmodSync),t.fchmodSync=i(t.fchmodSync),t.lchmodSync=i(t.lchmodSync),t.stat=c(t.stat),t.fstat=c(t.fstat),t.lstat=c(t.lstat),t.statSync=a(t.statSync),t.fstatSync=a(t.fstatSync),t.lstatSync=a(t.lstatSync),t.lchmod||(t.lchmod=function(t,e,r){r&&process.nextTick(r)},t.lchmodSync=function(){});t.lchown||(t.lchown=function(t,e,r,n){n&&process.nextTick(n)},t.lchownSync=function(){});"win32"===p&&(t.rename=(r=t.rename,function(e,n,i){var o=Date.now(),s=0;r(e,n,function c(a){if(a&&("EACCES"===a.code||"EPERM"===a.code)&&Date.now()-o<6e4)return setTimeout(function(){t.stat(n,function(t,o){t&&"ENOENT"===t.code?r(e,n,c):i(a)})},s),void(s<100&&(s+=10));i&&i(a)})}));var r;function n(e){return e?function(r,n,i){return e.call(t,r,n,function(t){u(t)&&(t=null),i&&i.apply(this,arguments)})}:e}function i(e){return e?function(r,n){try{return e.call(t,r,n)}catch(t){if(!u(t))throw t}}:e}function o(e){return e?function(r,n,i,o){return e.call(t,r,n,i,function(t){u(t)&&(t=null),o&&o.apply(this,arguments)})}:e}function s(e){return e?function(r,n,i){try{return e.call(t,r,n,i)}catch(t){if(!u(t))throw t}}:e}function c(e){return e?function(r,n){return e.call(t,r,function(t,e){if(!e)return n.apply(this,arguments);e.uid<0&&(e.uid+=4294967296),e.gid<0&&(e.gid+=4294967296),n&&n.apply(this,arguments)})}:e}function a(e){return e?function(r){var n=e.call(t,r);return n.uid<0&&(n.uid+=4294967296),n.gid<0&&(n.gid+=4294967296),n}:e}function u(t){if(!t)return!0;if("ENOSYS"===t.code)return!0;var e=!process.getuid||0!==process.getuid();return!(!e||"EINVAL"!==t.code&&"EPERM"!==t.code)}t.read=(h=t.read,function(e,r,n,i,o,s){var c;if(s&&"function"==typeof s){var a=0;c=function(u,f,l){if(u&&"EAGAIN"===u.code&&a<10)return a++,h.call(t,e,r,n,i,o,c);s.apply(this,arguments)}}return h.call(t,e,r,n,i,o,c)}),t.readSync=(f=t.readSync,function(e,r,n,i,o){for(var s=0;;)try{return f.call(t,e,r,n,i,o)}catch(t){if("EAGAIN"===t.code&&s<10){s++;continue}throw t}});var f;var h};var m=r.Stream,v=function(t){return{ReadStream:function e(r,n){if(!(this instanceof e))return new e(r,n);m.call(this);var i=this;this.path=r;this.fd=null;this.readable=!0;this.paused=!1;this.flags="r";this.mode=438;this.bufferSize=65536;n=n||{};var o=Object.keys(n);for(var s=0,c=o.length;s<c;s++){var a=o[s];this[a]=n[a]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick(function(){i._read()});t.open(this.path,this.flags,this.mode,function(t,e){if(t)return i.emit("error",t),void(i.readable=!1);i.fd=e,i.emit("open",e),i._read()})},WriteStream:function e(r,n){if(!(this instanceof e))return new e(r,n);m.call(this);this.path=r;this.fd=null;this.writable=!0;this.flags="w";this.encoding="binary";this.mode=438;this.bytesWritten=0;n=n||{};var i=Object.keys(n);for(var o=0,s=i.length;o<s;o++){var c=i[o];this[c]=n[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1;this._queue=[];null===this.fd&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}};var g=function(t){if(null===t||"object"!=typeof t)return t;if(t instanceof Object)var e={__proto__:t.__proto__};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e};var S=a(function(e){var r=[];var o,s,c=function(){};function a(t){y(t),t.gracefulify=a,t.FileReadStream=l,t.FileWriteStream=p,t.createReadStream=function(t,e){return new l(t,e)},t.createWriteStream=function(t,e){return new p(t,e)};var e=t.readFile;t.readFile=function(t,r,n){"function"==typeof r&&(n=r,r=null);return function t(r,n,i){return e(r,n,function(e){!e||"EMFILE"!==e.code&&"ENFILE"!==e.code?("function"==typeof i&&i.apply(this,arguments),f()):u([t,[r,n,i]])})}(t,r,n)};var r=t.writeFile;t.writeFile=function(t,e,n,i){"function"==typeof n&&(i=n,n=null);return function t(e,n,i,o){return r(e,n,i,function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?("function"==typeof o&&o.apply(this,arguments),f()):u([t,[e,n,i,o]])})}(t,e,n,i)};var n=t.appendFile;n&&(t.appendFile=function(t,e,r,i){"function"==typeof r&&(i=r,r=null);return function t(e,r,i,o){return n(e,r,i,function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?("function"==typeof o&&o.apply(this,arguments),f()):u([t,[e,r,i,o]])})}(t,e,r,i)});var i=t.readdir;function o(e){return i.apply(t,e)}if(t.readdir=function(t,e,r){var n=[t];"function"!=typeof e?n.push(e):r=e;return n.push(function(t,e){e&&e.sort&&e.sort(),!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?("function"==typeof r&&r.apply(this,arguments),f()):u([o,[n]])}),o(n)},"v0.8"===process.version.substr(0,4)){var s=v(t);l=s.ReadStream,p=s.WriteStream}var c=t.ReadStream;c&&(l.prototype=Object.create(c.prototype),l.prototype.open=function(){var t=this;m(t.path,t.flags,t.mode,function(e,r){e?(t.autoClose&&t.destroy(),t.emit("error",e)):(t.fd=r,t.emit("open",r),t.read())})});var h=t.WriteStream;function l(t,e){return this instanceof l?(c.apply(this,arguments),this):l.apply(Object.create(l.prototype),arguments)}function p(t,e){return this instanceof p?(h.apply(this,arguments),this):p.apply(Object.create(p.prototype),arguments)}h&&(p.prototype=Object.create(h.prototype),p.prototype.open=function(){var t=this;m(t.path,t.flags,t.mode,function(e,r){e?(t.destroy(),t.emit("error",e)):(t.fd=r,t.emit("open",r))})}),t.ReadStream=l,t.WriteStream=p;var d=t.open;function m(t,e,r,n){return"function"==typeof r&&(n=r,r=null),function t(e,r,n,i){return d(e,r,n,function(o,s){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?("function"==typeof i&&i.apply(this,arguments),f()):u([t,[e,r,n,i]])})}(t,e,r,n)}return t.open=m,t}function u(t){c("ENQUEUE",t[0].name,t[1]),r.push(t)}function f(){var t=r.shift();t&&(c("RETRY",t[0].name,t[1]),t[0].apply(null,t[1]))}n.debuglog?c=n.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(c=function(){var t=n.format.apply(n,arguments);t="GFS4: "+t.split(/\n/).join("\nGFS4: "),console.error(t)}),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){c(r),i.equal(r.length,0)}),e.exports=a(g(t)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!t.__patched&&(e.exports=a(t),t.__patched=!0),e.exports.close=(o=t.close,function(e,r){return o.call(t,e,function(t){t||f(),"function"==typeof r&&r.apply(this,arguments)})}),e.exports.closeSync=(s=t.closeSync,function(e){var r=s.apply(t,arguments);return f(),r}),/\bgraceful-fs\b/.test(t.closeSync.toString())||(t.closeSync=e.exports.closeSync,t.close=e.exports.close)}),w=(S.close,S.closeSync,a(function(t,e){const r=u,n=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>"function"==typeof S[t]);Object.keys(S).forEach(t=>{"promises"!==t&&(e[t]=S[t])}),n.forEach(t=>{e[t]=r(S[t])}),e.exists=function(t,e){return"function"==typeof e?S.exists(t,e):new Promise(e=>S.exists(t,e))},e.read=function(t,e,r,n,i,o){return"function"==typeof o?S.read(t,e,r,n,i,o):new Promise((o,s)=>{S.read(t,e,r,n,i,(t,e,r)=>{if(t)return s(t);o({bytesRead:e,buffer:r})})})},e.write=function(t,e,...r){return"function"==typeof r[r.length-1]?S.write(t,e,...r):new Promise((n,i)=>{S.write(t,e,...r,(t,e,r)=>{if(t)return i(t);n({bytesWritten:e,buffer:r})})})}}));w.exists,w.read,w.write;function b(t){return(t=o.normalize(o.resolve(t)).split(o.sep)).length>0?t[0]:null}const E=/[<>:"|?*]/;var k=function(t){const e=b(t);return t=t.replace(e,""),E.test(t)};const _=k,O=parseInt("0777",8);var N=function t(e,r,n,i){if("function"==typeof r?(n=r,r={}):r&&"object"==typeof r||(r={mode:r}),"win32"===process.platform&&_(e)){const t=new Error(e+" contains invalid WIN32 path characters.");return t.code="EINVAL",n(t)}let s=r.mode;const c=r.fs||S;void 0===s&&(s=O&~process.umask()),i||(i=null),n=n||function(){},e=o.resolve(e),c.mkdir(e,s,s=>{if(!s)return n(null,i=i||e);switch(s.code){case"ENOENT":if(o.dirname(e)===e)return n(s);t(o.dirname(e),r,(i,o)=>{i?n(i,o):t(e,r,n,o)});break;default:c.stat(e,(t,e)=>{t||!e.isDirectory()?n(s,i):n(null,i)})}})};const j=k,x=parseInt("0777",8);var A=function t(e,r,n){r&&"object"==typeof r||(r={mode:r});let i=r.mode;const s=r.fs||S;if("win32"===process.platform&&j(e)){const t=new Error(e+" contains invalid WIN32 path characters.");throw t.code="EINVAL",t}void 0===i&&(i=x&~process.umask()),n||(n=null),e=o.resolve(e);try{s.mkdirSync(e,i),n=n||e}catch(i){if("ENOENT"===i.code){if(o.dirname(e)===e)throw i;n=t(o.dirname(e),r,n),t(e,r,n)}else{let t;try{t=s.statSync(e)}catch(t){throw i}if(!t.isDirectory())throw i}}return n};const T=u(N);var F={mkdirs:T,mkdirsSync:A,mkdirp:T,mkdirpSync:A,ensureDir:T,ensureDirSync:A};var L=function(t,e,r,n){S.open(t,"r+",(t,i)=>{if(t)return n(t);S.futimes(i,e,r,t=>{S.close(i,e=>{n&&n(t||e)})})})},I=function(t,e,r){const n=S.openSync(t,"r+");return S.futimesSync(n,e,r),S.closeSync(n)},D=function(t){if("function"==typeof Buffer.allocUnsafe)try{return Buffer.allocUnsafe(t)}catch(e){return new Buffer(t)}return new Buffer(t)};const R=F.mkdirsSync,C=I,P=Symbol("notExist");function M(t,e,r,n){if(!n.filter||n.filter(e,r))return function(t,e,r,n){const i=(n.dereference?S.statSync:S.lstatSync)(e);if(i.isDirectory())return function(t,e,r,n,i){if(e===P)return function(t,e,r,n){return S.mkdirSync(r),G(e,r,n),S.chmodSync(r,t.mode)}(t,r,n,i);if(e&&!e.isDirectory())throw new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`);return G(r,n,i)}(i,t,e,r,n);if(i.isFile()||i.isCharacterDevice()||i.isBlockDevice())return function(t,e,r,n,i){return e===P?$(t,r,n,i):function(t,e,r,n){if(n.overwrite)return S.unlinkSync(r),$(t,e,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}(t,r,n,i)}(i,t,e,r,n);if(i.isSymbolicLink())return function(t,e,r,n){let i=S.readlinkSync(e);n.dereference&&(i=o.resolve(process.cwd(),i));if(t===P)return S.symlinkSync(i,r);{let t;try{t=S.readlinkSync(r)}catch(t){if("EINVAL"===t.code||"UNKNOWN"===t.code)return S.symlinkSync(i,r);throw t}if(n.dereference&&(t=o.resolve(process.cwd(),t)),B(i,t))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${t}'.`);if(S.statSync(r).isDirectory()&&B(t,i))throw new Error(`Cannot overwrite '${t}' with '${i}'.`);return function(t,e){return S.unlinkSync(e),S.symlinkSync(t,e)}(i,r)}}(t,e,r,n)}(t,e,r,n)}function $(t,e,r,n){return"function"==typeof S.copyFileSync?(S.copyFileSync(e,r),S.chmodSync(r,t.mode),n.preserveTimestamps?C(r,t.atime,t.mtime):void 0):function(t,e,r,n){const i=D(65536),o=S.openSync(e,"r"),s=S.openSync(r,"w",t.mode);let c=0;for(;c<t.size;){const t=S.readSync(o,i,0,65536,c);S.writeSync(s,i,0,t),c+=t}n.preserveTimestamps&&S.futimesSync(s,t.atime,t.mtime);S.closeSync(o),S.closeSync(s)}(t,e,r,n)}function G(t,e,r){S.readdirSync(t).forEach(n=>(function(t,e,r,n){const i=o.join(e,t),s=o.join(r,t);return M(J(i,s),i,s,n)})(n,t,e,r))}function B(t,e){const r=o.resolve(t).split(o.sep),n=o.resolve(e).split(o.sep);return r.reduce((t,e,r)=>t&&n[r]===e,!0)}function J(t,e){const{srcStat:r,destStat:n}=function(t,e){const r=S.statSync(t);let n;try{n=S.statSync(e)}catch(t){if("ENOENT"===t.code)return{srcStat:r,destStat:P};throw t}return{srcStat:r,destStat:n}}(t,e);if(n.ino&&n.ino===r.ino)throw new Error("Source and destination must not be the same.");if(r.isDirectory()&&B(t,e))throw new Error(`Cannot copy '${t}' to a subdirectory of itself, '${e}'.`);return n}var U={copySync:function(t,e,r){"function"==typeof r&&(r={filter:r}),(r=r||{}).clobber=!("clobber"in r&&!r.clobber),r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269");const n=J(t,e);if(r.filter&&!r.filter(t,e))return;const i=o.dirname(e);return S.existsSync(i)||R(i),M(n,t,e,r)}};var W={pathExists:f(function(t){return w.access(t).then(()=>!0).catch(()=>!1)}),pathExistsSync:w.existsSync};const q=F.mkdirs,Y=W.pathExists,Q=L,z=Symbol("notExist");function K(t,e,r,n,i){const s=o.dirname(r);Y(s,(o,c)=>o?i(o):c?X(t,e,r,n,i):void q(s,o=>o?i(o):X(t,e,r,n,i)))}function V(t,e,r,n,i,o){Promise.resolve(i.filter(r,n)).then(s=>s?e?t(e,r,n,i,o):t(r,n,i,o):o(),t=>o(t))}function X(t,e,r,n,i){return n.filter?V(Z,t,e,r,n,i):Z(t,e,r,n,i)}function Z(t,e,r,n,i){(n.dereference?S.stat:S.lstat)(e,(s,c)=>s?i(s):c.isDirectory()?function(t,e,r,n,i,o){if(e===z)return function(t,e,r,n,i){S.mkdir(r,o=>{if(o)return i(o);et(e,r,n,e=>e?i(e):S.chmod(r,t.mode,i))})}(t,r,n,i,o);if(e&&!e.isDirectory())return o(new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`));return et(r,n,i,o)}(c,t,e,r,n,i):c.isFile()||c.isCharacterDevice()||c.isBlockDevice()?function(t,e,r,n,i,o){return e===z?H(t,r,n,i,o):function(t,e,r,n,i){if(!n.overwrite)return n.errorOnExist?i(new Error(`'${r}' already exists`)):i();S.unlink(r,o=>o?i(o):H(t,e,r,n,i))}(t,r,n,i,o)}(c,t,e,r,n,i):c.isSymbolicLink()?function(t,e,r,n,i){S.readlink(e,(e,s)=>e?i(e):(n.dereference&&(s=o.resolve(process.cwd(),s)),t===z?S.symlink(s,r,i):void S.readlink(r,(e,c)=>e?"EINVAL"===e.code||"UNKNOWN"===e.code?S.symlink(s,r,i):i(e):(n.dereference&&(c=o.resolve(process.cwd(),c)),nt(s,c)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${c}'.`)):t.isDirectory()&&nt(c,s)?i(new Error(`Cannot overwrite '${c}' with '${s}'.`)):function(t,e,r){S.unlink(e,n=>n?r(n):S.symlink(t,e,r))}(s,r,i)))))}(t,e,r,n,i):void 0)}function H(t,e,r,n,i){return"function"==typeof S.copyFile?S.copyFile(e,r,e=>e?i(e):tt(t,r,n,i)):function(t,e,r,n,i){const o=S.createReadStream(e);o.on("error",t=>i(t)).once("open",()=>{const e=S.createWriteStream(r,{mode:t.mode});e.on("error",t=>i(t)).on("open",()=>o.pipe(e)).once("close",()=>tt(t,r,n,i))})}(t,e,r,n,i)}function tt(t,e,r,n){S.chmod(e,t.mode,i=>i?n(i):r.preserveTimestamps?Q(e,t.atime,t.mtime,n):n())}function et(t,e,r,n){S.readdir(t,(i,o)=>i?n(i):rt(o,t,e,r,n))}function rt(t,e,r,n,i){const s=t.pop();return s?function(t,e,r,n,i,s){const c=o.join(r,e),a=o.join(n,e);it(c,a,(e,o)=>{if(e)return s(e);X(o,c,a,i,e=>e?s(e):rt(t,r,n,i,s))})}(t,s,e,r,n,i):i()}function nt(t,e){const r=o.resolve(t).split(o.sep),n=o.resolve(e).split(o.sep);return r.reduce((t,e,r)=>t&&n[r]===e,!0)}function it(t,e,r){!function(t,e,r){S.stat(t,(t,n)=>{if(t)return r(t);S.stat(e,(t,e)=>t?"ENOENT"===t.code?r(null,{srcStat:n,destStat:z}):r(t):r(null,{srcStat:n,destStat:e}))})}(t,e,(n,i)=>{if(n)return r(n);const{srcStat:o,destStat:s}=i;return s.ino&&s.ino===o.ino?r(new Error("Source and destination must not be the same.")):o.isDirectory()&&nt(t,e)?r(new Error(`Cannot copy '${t}' to a subdirectory of itself, '${e}'.`)):r(null,s)})}var ot={copy:u(function(t,e,r,n){"function"!=typeof r||n?"function"==typeof r&&(r={filter:r}):(n=r,r={}),n=n||function(){},(r=r||{}).clobber=!("clobber"in r&&!r.clobber),r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269"),it(t,e,(i,o)=>i?n(i):r.filter?V(K,o,t,e,r,n):K(o,t,e,r,n))})};const st="win32"===process.platform;function ct(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(e=>{t[e]=t[e]||S[e],t[e+="Sync"]=t[e]||S[e]}),t.maxBusyTries=t.maxBusyTries||3}function at(t,e,r){let n=0;"function"==typeof e&&(r=e,e={}),i(t,"rimraf: missing path"),i.strictEqual(typeof t,"string","rimraf: path should be a string"),i.strictEqual(typeof r,"function","rimraf: callback function required"),i(e,"rimraf: invalid options argument provided"),i.strictEqual(typeof e,"object","rimraf: options should be object"),ct(e),ut(t,e,function i(o){if(o){if(("EBUSY"===o.code||"ENOTEMPTY"===o.code||"EPERM"===o.code)&&n<e.maxBusyTries){return n++,setTimeout(()=>ut(t,e,i),100*n)}"ENOENT"===o.code&&(o=null)}r(o)})}function ut(t,e,r){i(t),i(e),i("function"==typeof r),e.lstat(t,(n,i)=>n&&"ENOENT"===n.code?r(null):n&&"EPERM"===n.code&&st?ft(t,e,n,r):i&&i.isDirectory()?lt(t,e,n,r):void e.unlink(t,n=>{if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return st?ft(t,e,n,r):lt(t,e,n,r);if("EISDIR"===n.code)return lt(t,e,n,r)}return r(n)}))}function ft(t,e,r,n){i(t),i(e),i("function"==typeof n),r&&i(r instanceof Error),e.chmod(t,438,i=>{i?n("ENOENT"===i.code?null:r):e.stat(t,(i,o)=>{i?n("ENOENT"===i.code?null:r):o.isDirectory()?lt(t,e,r,n):e.unlink(t,n)})})}function ht(t,e,r){let n;i(t),i(e),r&&i(r instanceof Error);try{e.chmodSync(t,438)}catch(t){if("ENOENT"===t.code)return;throw r}try{n=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw r}n.isDirectory()?dt(t,e,r):e.unlinkSync(t)}function lt(t,e,r,n){i(t),i(e),r&&i(r instanceof Error),i("function"==typeof n),e.rmdir(t,s=>{!s||"ENOTEMPTY"!==s.code&&"EEXIST"!==s.code&&"EPERM"!==s.code?s&&"ENOTDIR"===s.code?n(r):n(s):function(t,e,r){i(t),i(e),i("function"==typeof r),e.readdir(t,(n,i)=>{if(n)return r(n);let s,c=i.length;if(0===c)return e.rmdir(t,r);i.forEach(n=>{at(o.join(t,n),e,n=>{if(!s)return n?r(s=n):void(0==--c&&e.rmdir(t,r))})})})}(t,e,n)})}function pt(t,e){let r;ct(e=e||{}),i(t,"rimraf: missing path"),i.strictEqual(typeof t,"string","rimraf: path should be a string"),i(e,"rimraf: missing options"),i.strictEqual(typeof e,"object","rimraf: options should be object");try{r=e.lstatSync(t)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&st&&ht(t,e,r)}try{r&&r.isDirectory()?dt(t,e,null):e.unlinkSync(t)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return st?ht(t,e,r):dt(t,e,r);if("EISDIR"!==r.code)throw r;dt(t,e,r)}}function dt(t,e,r){i(t),i(e),r&&i(r instanceof Error);try{e.rmdirSync(t)}catch(n){if("ENOTDIR"===n.code)throw r;if("ENOTEMPTY"===n.code||"EEXIST"===n.code||"EPERM"===n.code)!function(t,e){if(i(t),i(e),e.readdirSync(t).forEach(r=>pt(o.join(t,r),e)),!st){const r=e.rmdirSync(t,e);return r}{const r=Date.now();do{try{const r=e.rmdirSync(t,e);return r}catch(t){}}while(Date.now()-r<500)}}(t,e);else if("ENOENT"!==n.code)throw n}}var yt=at;at.sync=pt;var mt={remove:u(yt),removeSync:yt.sync};const vt=u(function(e,r){r=r||function(){},t.readdir(e,(t,n)=>{if(t)return F.mkdirs(e,r);n=n.map(t=>o.join(e,t)),function t(){const e=n.pop();if(!e)return r();mt.remove(e,e=>{if(e)return r(e);t()})}()})});function gt(e){let r;try{r=t.readdirSync(e)}catch(t){return F.mkdirsSync(e)}r.forEach(t=>{t=o.join(e,t),mt.removeSync(t)})}var St={emptyDirSync:gt,emptydirSync:gt,emptyDir:vt,emptydir:vt};const wt=W.pathExists;var bt={createFile:u(function(t,e){function r(){S.writeFile(t,"",t=>{if(t)return e(t);e()})}S.stat(t,(n,i)=>{if(!n&&i.isFile())return e();const s=o.dirname(t);wt(s,(t,n)=>t?e(t):n?r():void F.mkdirs(s,t=>{if(t)return e(t);r()}))})}),createFileSync:function(t){let e;try{e=S.statSync(t)}catch(t){}if(e&&e.isFile())return;const r=o.dirname(t);S.existsSync(r)||F.mkdirsSync(r),S.writeFileSync(t,"")}};const Et=W.pathExists;var kt={createLink:u(function(t,e,r){function n(t,e){S.link(t,e,t=>{if(t)return r(t);r(null)})}Et(e,(i,s)=>i?r(i):s?r(null):void S.lstat(t,i=>{if(i)return i.message=i.message.replace("lstat","ensureLink"),r(i);const s=o.dirname(e);Et(s,(i,o)=>i?r(i):o?n(t,e):void F.mkdirs(s,i=>{if(i)return r(i);n(t,e)}))}))}),createLinkSync:function(t,e){if(S.existsSync(e))return;try{S.lstatSync(t)}catch(t){throw t.message=t.message.replace("lstat","ensureLink"),t}const r=o.dirname(e);return S.existsSync(r)?S.linkSync(t,e):(F.mkdirsSync(r),S.linkSync(t,e))}};const _t=W.pathExists;var Ot=function(t,e,r){if(o.isAbsolute(t))return S.lstat(t,e=>e?(e.message=e.message.replace("lstat","ensureSymlink"),r(e)):r(null,{toCwd:t,toDst:t}));{const n=o.dirname(e),i=o.join(n,t);return _t(i,(e,s)=>e?r(e):s?r(null,{toCwd:i,toDst:t}):S.lstat(t,e=>e?(e.message=e.message.replace("lstat","ensureSymlink"),r(e)):r(null,{toCwd:t,toDst:o.relative(n,t)})))}},Nt=function(t,e){let r;if(o.isAbsolute(t)){if(!(r=S.existsSync(t)))throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}{const n=o.dirname(e),i=o.join(n,t);if(r=S.existsSync(i))return{toCwd:i,toDst:t};if(!(r=S.existsSync(t)))throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:o.relative(n,t)}}};var jt=function(t,e,r){if(r="function"==typeof e?e:r,e="function"!=typeof e&&e)return r(null,e);S.lstat(t,(t,n)=>{if(t)return r(null,"file");e=n&&n.isDirectory()?"dir":"file",r(null,e)})},xt=function(t,e){let r;if(e)return e;try{r=S.lstatSync(t)}catch(t){return"file"}return r&&r.isDirectory()?"dir":"file"};const At=u,Tt=F.mkdirs,Ft=F.mkdirsSync,Lt=Ot,It=Nt,Dt=jt,Rt=xt,Ct=W.pathExists;var Pt,Mt={createSymlink:At(function(t,e,r,n){n="function"==typeof r?r:n,r="function"!=typeof r&&r,Ct(e,(i,s)=>i?n(i):s?n(null):void Lt(t,e,(i,s)=>{if(i)return n(i);t=s.toDst,Dt(s.toCwd,r,(r,i)=>{if(r)return n(r);const s=o.dirname(e);Ct(s,(r,o)=>r?n(r):o?S.symlink(t,e,i,n):void Tt(s,r=>{if(r)return n(r);S.symlink(t,e,i,n)}))})}))}),createSymlinkSync:function(t,e,r){if(S.existsSync(e))return;const n=It(t,e);t=n.toDst,r=Rt(n.toCwd,r);const i=o.dirname(e);return S.existsSync(i)?S.symlinkSync(t,e,r):(Ft(i),S.symlinkSync(t,e,r))}},$t={createFile:bt.createFile,createFileSync:bt.createFileSync,ensureFile:bt.createFile,ensureFileSync:bt.createFileSync,createLink:kt.createLink,createLinkSync:kt.createLinkSync,ensureLink:kt.createLink,ensureLinkSync:kt.createLinkSync,createSymlink:Mt.createSymlink,createSymlinkSync:Mt.createSymlinkSync,ensureSymlink:Mt.createSymlink,ensureSymlinkSync:Mt.createSymlinkSync};try{Pt=S}catch(e){Pt=t}function Gt(t,e){var r,n="\n";return"object"==typeof e&&null!==e&&(e.spaces&&(r=e.spaces),e.EOL&&(n=e.EOL)),JSON.stringify(t,e?e.replacer:null,r).replace(/\n/g,n)+n}function Bt(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t=t.replace(/^\uFEFF/,"")}var Jt={readFile:function(t,e,r){null==r&&(r=e,e={}),"string"==typeof e&&(e={encoding:e});var n=(e=e||{}).fs||Pt,i=!0;"throws"in e&&(i=e.throws),n.readFile(t,e,function(n,o){if(n)return r(n);var s;o=Bt(o);try{s=JSON.parse(o,e?e.reviver:null)}catch(e){return i?(e.message=t+": "+e.message,r(e)):r(null,null)}r(null,s)})},readFileSync:function(t,e){"string"==typeof(e=e||{})&&(e={encoding:e});var r=e.fs||Pt,n=!0;"throws"in e&&(n=e.throws);try{var i=r.readFileSync(t,e);return i=Bt(i),JSON.parse(i,e.reviver)}catch(e){if(n)throw e.message=t+": "+e.message,e;return null}},writeFile:function(t,e,r,n){null==n&&(n=r,r={});var i=(r=r||{}).fs||Pt,o="";try{o=Gt(e,r)}catch(t){return void(n&&n(t,null))}i.writeFile(t,o,r,n)},writeFileSync:function(t,e,r){var n=(r=r||{}).fs||Pt,i=Gt(e,r);return n.writeFileSync(t,i,r)}};const Ut=u;var Wt={readJson:Ut(Jt.readFile),readJsonSync:Jt.readFileSync,writeJson:Ut(Jt.writeFile),writeJsonSync:Jt.writeFileSync};const qt=W.pathExists;var Yt=function(t,e,r,n){"function"==typeof r&&(n=r,r={});const i=o.dirname(t);qt(i,(o,s)=>o?n(o):s?Wt.writeJson(t,e,r,n):void F.mkdirs(i,i=>{if(i)return n(i);Wt.writeJson(t,e,r,n)}))};var Qt=function(t,e,r){const n=o.dirname(t);S.existsSync(n)||F.mkdirsSync(n),Wt.writeJsonSync(t,e,r)};const zt=u;Wt.outputJson=zt(Yt),Wt.outputJsonSync=Qt,Wt.outputJSON=Wt.outputJson,Wt.outputJSONSync=Wt.outputJsonSync,Wt.writeJSON=Wt.writeJson,Wt.writeJSONSync=Wt.writeJsonSync,Wt.readJSON=Wt.readJson,Wt.readJSONSync=Wt.readJsonSync;var Kt=Wt;const Vt=U.copySync,Xt=mt.removeSync,Zt=F.mkdirsSync;function Ht(t,e,r){return S.statSync(t).isDirectory()?function(t,e,r){const n={overwrite:!1};r?(Xt(e),i()):i();function i(){return Vt(t,e,n),Xt(t)}}(t,e,r):function(t,e,r){const n=D(65536),i=r?"w":"wx",o=S.openSync(t,"r"),s=S.fstatSync(o),c=S.openSync(e,i,s.mode);let a=0;for(;a<s.size;){const t=S.readSync(o,n,0,65536,a);S.writeSync(c,n,0,t),a+=t}return S.closeSync(o),S.closeSync(c),S.unlinkSync(t)}(t,e,r)}var te={moveSync:function t(e,r,n){const i=(n=n||{}).overwrite||n.clobber||!1;if(e=o.resolve(e),r=o.resolve(r),e===r)return S.accessSync(e);if(function(t,e){try{return S.statSync(t).isDirectory()&&t!==e&&e.indexOf(t)>-1&&e.split(o.dirname(t)+o.sep)[1].split(o.sep)[0]===o.basename(t)}catch(t){return!1}}(e,r))throw new Error(`Cannot move '${e}' into itself '${r}'.`);Zt(o.dirname(r)),function(){if(i)try{S.renameSync(e,r)}catch(o){if("ENOTEMPTY"===o.code||"EEXIST"===o.code||"EPERM"===o.code)return Xt(r),n.overwrite=!1,t(e,r,n);if("EXDEV"!==o.code)throw o;return Ht(e,r,i)}else try{S.linkSync(e,r),S.unlinkSync(e)}catch(t){if("EXDEV"===t.code||"EISDIR"===t.code||"EPERM"===t.code||"ENOTSUP"===t.code)return Ht(e,r,i);throw t}}()}};const ee=u,re=ot.copy,ne=mt.remove,ie=F.mkdirp,oe=W.pathExists;function se(t,e,r,n){S.rename(t,e,i=>i?"EXDEV"!==i.code?n(i):function(t,e,r,n){re(t,e,{overwrite:r,errorOnExist:!0},e=>e?n(e):ne(t,n))}(t,e,r,n):n())}var ce={move:ee(function(t,e,r,n){"function"==typeof r&&(n=r,r={});const i=r.overwrite||r.clobber||!1;if(t=o.resolve(t),e=o.resolve(e),t===e)return S.access(t,n);S.stat(t,(r,s)=>r?n(r):s.isDirectory()&&function(t,e){const r=t.split(o.sep),n=e.split(o.sep);return r.reduce((t,e,r)=>t&&n[r]===e,!0)}(t,e)?n(new Error(`Cannot move '${t}' to a subdirectory of itself, '${e}'.`)):void ie(o.dirname(e),r=>r?n(r):function(t,e,r,n){if(r)return ne(e,i=>i?n(i):se(t,e,r,n));oe(e,(i,o)=>i?n(i):o?n(new Error("dest already exists.")):se(t,e,r,n))}(t,e,i,n)))})};const ae=W.pathExists;var ue={outputFile:u(function(t,e,r,n){"function"==typeof r&&(n=r,r="utf8");const i=o.dirname(t);ae(i,(o,s)=>o?n(o):s?S.writeFile(t,e,r,n):void F.mkdirs(i,i=>{if(i)return n(i);S.writeFile(t,e,r,n)}))}),outputFileSync:function(t,...e){const r=o.dirname(t);if(S.existsSync(r))return S.writeFileSync(t,...e);F.mkdirsSync(r),S.writeFileSync(t,...e)}},fe=a(function(e){e.exports=Object.assign({},w,U,ot,St,$t,Kt,F,te,ce,ue,W,mt),Object.getOwnPropertyDescriptor(t,"promises")&&Object.defineProperty(e.exports,"promises",{get:()=>t.promises})}),he="win32"===process.platform,le=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function pe(t){return"function"==typeof t?t:function(){var t;if(le){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}()}o.normalize;if(he)var de=/(.*?)(?:[\/\\]+|$)/g;else de=/(.*?)(?:[\/]+|$)/g;if(he)var ye=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else ye=/^[\/]*/;var me={realpathSync:function(e,r){if(e=o.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var n,i,s,c,a=e,u={},f={};function h(){var r=ye.exec(e);n=r[0].length,i=r[0],s=r[0],c="",he&&!f[s]&&(t.lstatSync(s),f[s]=!0)}for(h();n<e.length;){de.lastIndex=n;var l=de.exec(e);if(c=i,i+=l[0],s=c+l[1],n=de.lastIndex,!(f[s]||r&&r[s]===s)){var p;if(r&&Object.prototype.hasOwnProperty.call(r,s))p=r[s];else{var d=t.lstatSync(s);if(!d.isSymbolicLink()){f[s]=!0,r&&(r[s]=s);continue}var y=null;if(!he){var m=d.dev.toString(32)+":"+d.ino.toString(32);u.hasOwnProperty(m)&&(y=u[m])}null===y&&(t.statSync(s),y=t.readlinkSync(s)),p=o.resolve(c,y),r&&(r[s]=p),he||(u[m]=y)}e=o.resolve(p,e.slice(n)),h()}}return r&&(r[a]=e),e},realpath:function(e,r,n){if("function"!=typeof n&&(n=pe(r),r=null),e=o.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(n.bind(null,null,r[e]));var i,s,c,a,u=e,f={},h={};function l(){var r=ye.exec(e);i=r[0].length,s=r[0],c=r[0],a="",he&&!h[c]?t.lstat(c,function(t){if(t)return n(t);h[c]=!0,p()}):process.nextTick(p)}function p(){if(i>=e.length)return r&&(r[u]=e),n(null,e);de.lastIndex=i;var o=de.exec(e);return a=s,s+=o[0],c=a+o[1],i=de.lastIndex,h[c]||r&&r[c]===c?process.nextTick(p):r&&Object.prototype.hasOwnProperty.call(r,c)?m(r[c]):t.lstat(c,d)}function d(e,i){if(e)return n(e);if(!i.isSymbolicLink())return h[c]=!0,r&&(r[c]=c),process.nextTick(p);if(!he){var o=i.dev.toString(32)+":"+i.ino.toString(32);if(f.hasOwnProperty(o))return y(null,f[o],c)}t.stat(c,function(e){if(e)return n(e);t.readlink(c,function(t,e){he||(f[o]=e),y(t,e)})})}function y(t,e,i){if(t)return n(t);var s=o.resolve(a,e);r&&(r[i]=s),m(s)}function m(t){e=o.resolve(t,e.slice(i)),l()}l()}},ve=ke;ke.realpath=ke,ke.sync=_e,ke.realpathSync=_e,ke.monkeypatch=function(){t.realpath=ke,t.realpathSync=_e},ke.unmonkeypatch=function(){t.realpath=ge,t.realpathSync=Se};var ge=t.realpath,Se=t.realpathSync,we=process.version,be=/^v[0-5]\./.test(we);function Ee(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function ke(t,e,r){if(be)return ge(t,e,r);"function"==typeof e&&(r=e,e=null),ge(t,e,function(n,i){Ee(n)?me.realpath(t,e,r):r(n,i)})}function _e(t,e){if(be)return Se(t,e);try{return Se(t,e)}catch(r){if(Ee(r))return me.realpathSync(t,e);throw r}}var Oe=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n],n);Ne(i)?r.push.apply(r,i):r.push(i)}return r},Ne=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},je=xe;function xe(t,e,r){t instanceof RegExp&&(t=Ae(t,r)),e instanceof RegExp&&(e=Ae(e,r));var n=Te(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function Ae(t,e){var r=e.match(t);return r?r[0]:null}function Te(t,e,r){var n,i,o,s,c,a=r.indexOf(t),u=r.indexOf(e,a+1),f=a;if(a>=0&&u>0){for(n=[],o=r.length;f>=0&&!c;)f==a?(n.push(f),a=r.indexOf(t,f+1)):1==n.length?c=[n.pop(),u]:((i=n.pop())<o&&(o=i,s=u),u=r.indexOf(e,f+1)),f=a<u&&a>=0?a:u;n.length&&(c=[o,s])}return c}xe.range=Te;var Fe=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return function t(e,r){var n=[];var i=je("{","}",e);if(!i||/\$$/.test(i.pre))return[e];var o=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body);var s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body);var c=o||s;var a=i.body.indexOf(",")>=0;if(!c&&!a)return i.post.match(/,.*\}/)?(e=i.pre+"{"+i.body+De+i.post,t(e)):[e];var u;if(c)u=i.body.split(/\.\./);else if(1===(u=function t(e){if(!e)return[""];var r=[];var n=je("{","}",e);if(!n)return e.split(",");var i=n.pre;var o=n.body;var s=n.post;var c=i.split(",");c[c.length-1]+="{"+o+"}";var a=t(s);s.length&&(c[c.length-1]+=a.shift(),c.push.apply(c,a));r.push.apply(r,c);return r}(i.body)).length&&1===(u=t(u[0],!1).map($e)).length){var f=i.post.length?t(i.post,!1):[""];return f.map(function(t){return i.pre+u[0]+t})}var h=i.pre;var f=i.post.length?t(i.post,!1):[""];var l;if(c){var p=Pe(u[0]),d=Pe(u[1]),y=Math.max(u[0].length,u[1].length),m=3==u.length?Math.abs(Pe(u[2])):1,v=Be,g=d<p;g&&(m*=-1,v=Je);var S=u.some(Ge);l=[];for(var w=p;v(w,d);w+=m){var b;if(s)"\\"===(b=String.fromCharCode(w))&&(b="");else if(b=String(w),S){var E=y-b.length;if(E>0){var k=new Array(E+1).join("0");b=w<0?"-"+k+b.slice(1):k+b}}l.push(b)}}else l=Oe(u,function(e){return t(e,!1)});for(var _=0;_<l.length;_++)for(var O=0;O<f.length;O++){var N=h+l[_]+f[O];(!r||c||N)&&n.push(N)}return n}(function(t){return t.split("\\\\").join(Le).split("\\{").join(Ie).split("\\}").join(De).split("\\,").join(Re).split("\\.").join(Ce)}(t),!0).map(Me)},Le="\0SLASH"+Math.random()+"\0",Ie="\0OPEN"+Math.random()+"\0",De="\0CLOSE"+Math.random()+"\0",Re="\0COMMA"+Math.random()+"\0",Ce="\0PERIOD"+Math.random()+"\0";function Pe(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Me(t){return t.split(Le).join("\\").split(Ie).join("{").split(De).join("}").split(Re).join(",").split(Ce).join(".")}function $e(t){return"{"+t+"}"}function Ge(t){return/^-?0\d/.test(t)}function Be(t,e){return t<=e}function Je(t,e){return t>=e}var Ue=tr;tr.Minimatch=er;var We={sep:"/"};try{We=o}catch(t){}var qe=tr.GLOBSTAR=er.GLOBSTAR={},Ye={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Qe="[^/]",ze=Qe+"*?",Ke="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Ve="(?:(?!(?:\\/|^)\\.).)*?",Xe="().*{}+?[]^$\\!".split("").reduce(function(t,e){return t[e]=!0,t},{});var Ze=/\/+/;function He(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function tr(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new er(e,r).match(t))}function er(t,e){if(!(this instanceof er))return new er(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==We.sep&&(t=t.split(We.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function rr(t,e){if(e||(e=this instanceof er?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:Fe(t)}tr.filter=function(t,e){return e=e||{},function(r,n,i){return tr(r,t,e)}},tr.defaults=function(t){if(!t||!Object.keys(t).length)return tr;var e=tr,r=function(r,n,i){return e.minimatch(r,n,He(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,He(t,n))},r},er.defaults=function(t){return t&&Object.keys(t).length?tr.defaults(t).Minimatch:er},er.prototype.debug=function(){},er.prototype.make=function(){if(this._made)return;var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map(function(t){return t.split(Ze)}),this.debug(this.pattern,r),r=r.map(function(t,e,r){return t.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(t){return-1===t.indexOf(!1)}),this.debug(this.pattern,r),this.set=r},er.prototype.parseNegate=function(){var t=this.pattern,e=!1,r=this.options,n=0;if(r.nonegate)return;for(var i=0,o=t.length;i<o&&"!"===t.charAt(i);i++)e=!e,n++;n&&(this.pattern=t.substr(n));this.negate=e},tr.braceExpand=function(t,e){return rr(t,e)},er.prototype.braceExpand=rr,er.prototype.parse=function(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===t)return qe;if(""===t)return"";var n,i="",o=!!r.nocase,s=!1,c=[],a=[],u=!1,f=-1,h=-1,l="."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",p=this;function d(){if(n){switch(n){case"*":i+=ze,o=!0;break;case"?":i+=Qe,o=!0;break;default:i+="\\"+n}p.debug("clearStateChar %j %j",n,i),n=!1}}for(var y,m=0,v=t.length;m<v&&(y=t.charAt(m));m++)if(this.debug("%s\t%s %s %j",t,m,i,y),s&&Xe[y])i+="\\"+y,s=!1;else switch(y){case"/":return!1;case"\\":d(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,m,i,y),u){this.debug("  in class"),"!"===y&&m===h+1&&(y="^"),i+=y;continue}p.debug("call clearStateChar %j",n),d(),n=y,r.noext&&d();continue;case"(":if(u){i+="(";continue}if(!n){i+="\\(";continue}c.push({type:n,start:m-1,reStart:i.length,open:Ye[n].open,close:Ye[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(u||!c.length){i+="\\)";continue}d(),o=!0;var g=c.pop();i+=g.close,"!"===g.type&&a.push(g),g.reEnd=i.length;continue;case"|":if(u||!c.length||s){i+="\\|",s=!1;continue}d(),i+="|";continue;case"[":if(d(),u){i+="\\"+y;continue}u=!0,h=m,f=i.length,i+=y;continue;case"]":if(m===h+1||!u){i+="\\"+y,s=!1;continue}if(u)var S,w=t.substring(h+1,m);o=!0,u=!1,i+=y;continue;default:d(),s?s=!1:!Xe[y]||"^"===y&&u||(i+="\\"),i+=y}u&&(w=t.substr(h+1),S=this.parse(w,nr),i=i.substr(0,f)+"\\["+S[0],o=o||S[1]);for(g=c.pop();g;g=c.pop()){var b=i.slice(g.reStart+g.open.length);this.debug("setting tail",i,g),b=b.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(t,e,r){return r||(r="\\"),e+e+r+"|"}),this.debug("tail=%j\n   %s",b,b,g,i);var E="*"===g.type?ze:"?"===g.type?Qe:"\\"+g.type;o=!0,i=i.slice(0,g.reStart)+E+"\\("+b}d(),s&&(i+="\\\\");var k=!1;switch(i.charAt(0)){case".":case"[":case"(":k=!0}for(var _=a.length-1;_>-1;_--){var O=a[_],N=i.slice(0,O.reStart),j=i.slice(O.reStart,O.reEnd-8),x=i.slice(O.reEnd-8,O.reEnd),A=i.slice(O.reEnd);x+=A;var T=N.split("(").length-1,F=A;for(m=0;m<T;m++)F=F.replace(/\)[+*?]?/,"");var L="";""===(A=F)&&e!==nr&&(L="$");var I=N+j+A+L+x;i=I}""!==i&&o&&(i="(?=.)"+i);k&&(i=l+i);if(e===nr)return[i,o];if(!o)return t.replace(/\\(.)/g,"$1");var D=r.nocase?"i":"";try{var R=new RegExp("^"+i+"$",D)}catch(t){return new RegExp("$.")}return R._glob=t,R._src=i,R};var nr={};tr.makeRe=function(t,e){return new er(t,e||{}).makeRe()},er.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?ze:e.dot?Ke:Ve,n=e.nocase?"i":"",i=t.map(function(t){return t.map(function(t){return t===qe?r:"string"==typeof t?t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):t._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(t){this.regexp=!1}return this.regexp},tr.match=function(t,e,r){var n=new er(e,r=r||{});return t=t.filter(function(t){return n.match(t)}),n.options.nonull&&!t.length&&t.push(e),t},er.prototype.match=function(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==We.sep&&(t=t.split(We.sep).join("/"));t=t.split(Ze),this.debug(this.pattern,"split",t);var n,i,o=this.set;for(this.debug(this.pattern,"set",o),i=t.length-1;i>=0&&!(n=t[i]);i--);for(i=0;i<o.length;i++){var s=o[i],c=t;r.matchBase&&1===s.length&&(c=[n]);var a=this.matchOne(c,s,e);if(a)return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},er.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,o=0,s=t.length,c=e.length;i<s&&o<c;i++,o++){this.debug("matchOne loop");var a,u=e[o],f=t[i];if(this.debug(e,u,f),!1===u)return!1;if(u===qe){this.debug("GLOBSTAR",[e,u,f]);var h=i,l=o+1;if(l===c){for(this.debug("** at the end");i<s;i++)if("."===t[i]||".."===t[i]||!n.dot&&"."===t[i].charAt(0))return!1;return!0}for(;h<s;){var p=t[h];if(this.debug("\nglobstar while",t,h,e,l,p),this.matchOne(t.slice(h),e.slice(l),r))return this.debug("globstar found match!",h,s,p),!0;if("."===p||".."===p||!n.dot&&"."===p.charAt(0)){this.debug("dot detected!",t,h,e,l);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",t,h,e,l),h!==s))}if("string"==typeof u?(a=n.nocase?f.toLowerCase()===u.toLowerCase():f===u,this.debug("string match",u,f,a)):(a=f.match(u),this.debug("pattern match",u,f,a)),!a)return!1}if(i===s&&o===c)return!0;if(i===s)return r;if(o===c)return i===s-1&&""===t[i];throw new Error("wtf?")};var ir=a(function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}),or=a(function(t){try{var e=n;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=ir}});function sr(t){return"/"===t.charAt(0)}function cr(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),r=e[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(e[2]||n)}var ar="win32"===process.platform?cr:sr,ur=sr,fr=cr;ar.posix=ur,ar.win32=fr;var hr=kr,lr=Er,pr=function(t,e,r){r||(r={});if(r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0);t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(_r))}(t,r),t.changedCwd=!1;var n=process.cwd();wr(r,"cwd")?(t.cwd=o.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=n;t.root=r.root||o.resolve(t.cwd,"/"),t.root=o.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/"));t.cwdAbs=ar(t.cwd)?t.cwd:Or(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/"));t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new br(e,r),t.options=t.minimatch.options},dr=wr,yr=Or,mr=function(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var o=t.matches[n];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);e?r.push.apply(r,s):s.forEach(function(t){r[t]=!0})}else if(t.nonull){var c=t.minimatch.globSet[n];e?r.push(c):r[c]=!0}}e||(r=Object.keys(r));t.nosort||(r=r.sort(t.nocase?Er:kr));if(t.mark){for(var n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[Or(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}t.ignore.length&&(r=r.filter(function(e){return!Nr(t,e)}));t.found=r},vr=function(t,e){var r=Or(t,e),n=t.cache[r],i=e;if(n){var o="DIR"===n||Array.isArray(n),s="/"===e.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==e){var c=Or(t,i);t.statCache[c]=t.statCache[r],t.cache[c]=t.cache[r]}}return i},gr=Nr,Sr=function(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return!(!t.gmatcher||!t.gmatcher.match(e))})};function wr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var br=Ue.Minimatch;function Er(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function kr(t,e){return t.localeCompare(e)}function _r(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new br(r,{dot:!0})}return{matcher:new br(t,{dot:!0}),gmatcher:e}}function Or(t,e){var r=e;return r="/"===e.charAt(0)?o.join(t.root,e):ar(e)||""===e?e:t.changedCwd?o.resolve(t.cwd,e):o.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function Nr(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))})}var jr={alphasort:hr,alphasorti:lr,setopts:pr,ownProp:dr,makeAbs:yr,finish:mr,mark:vr,isIgnored:gr,childrenIgnored:Sr},xr=Ir;Ir.GlobSync=Dr;var Ar=jr.setopts,Tr=jr.ownProp,Fr=jr.childrenIgnored,Lr=jr.isIgnored;function Ir(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new Dr(t,e).found}function Dr(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof Dr))return new Dr(t,e);if(Ar(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}Dr.prototype._finish=function(){if(i(this instanceof Dr),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i),n[ve.realpathSync(i,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;n[t._makeAbs(i)]=!0}})}jr.finish(this)},Dr.prototype._process=function(t,e,r){i(this instanceof Dr);for(var n,o=0;"string"==typeof t[o];)o++;switch(o){case t.length:return void this._processSimple(t.join("/"),e);case 0:n=null;break;default:n=t.slice(0,o).join("/")}var s,c=t.slice(o);null===n?s=".":ar(n)||ar(t.join("/"))?(n&&ar(n)||(n="/"+n),s=n):s=n;var a=this._makeAbs(s);Fr(this,s)||(c[0]===Ue.GLOBSTAR?this._processGlobStar(n,s,a,c,e,r):this._processReaddir(n,s,a,c,e,r))},Dr.prototype._processReaddir=function(t,e,r,n,i,s){var c=this._readdir(r,s);if(c){for(var a=n[0],u=!!this.minimatch.negate,f=a._glob,h=this.dot||"."===f.charAt(0),l=[],p=0;p<c.length;p++){if("."!==(m=c[p]).charAt(0)||h)(u&&!t?!m.match(a):m.match(a))&&l.push(m)}var d=l.length;if(0!==d)if(1!==n.length||this.mark||this.stat){n.shift();for(p=0;p<d;p++){var y;m=l[p];y=t?[t,m]:[m],this._process(y.concat(n),i,s)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var p=0;p<d;p++){var m=l[p];t&&(m="/"!==t.slice(-1)?t+"/"+m:t+m),"/"!==m.charAt(0)||this.nomount||(m=o.join(this.root,m)),this._emitMatch(i,m)}}}},Dr.prototype._emitMatch=function(t,e){if(!Lr(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},Dr.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var r,n;try{n=t.lstatSync(e)}catch(t){if("ENOENT"===t.code)return null}var i=n&&n.isSymbolicLink();return this.symlinks[e]=i,i||!n||n.isDirectory()?r=this._readdir(e,!1):this.cache[e]="FILE",r},Dr.prototype._readdir=function(e,r){if(r&&!Tr(this.symlinks,e))return this._readdirInGlobStar(e);if(Tr(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,t.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},Dr.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},Dr.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},Dr.prototype._processGlobStar=function(t,e,r,n,i,o){var s=this._readdir(r,o);if(s){var c=n.slice(1),a=t?[t]:[],u=a.concat(c);this._process(u,i,!1);var f=s.length;if(!this.symlinks[r]||!o)for(var h=0;h<f;h++){if("."!==s[h].charAt(0)||this.dot){var l=a.concat(s[h],c);this._process(l,i,!0);var p=a.concat(s[h],n);this._process(p,i,!0)}}}},Dr.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&ar(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=o.join(this.root,t):(t=o.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},Dr.prototype._stat=function(e){var r=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&Tr(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return i;if(n&&"FILE"===i)return!1}var o=this.statCache[r];if(!o){var s;try{s=t.lstatSync(r)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[r]=!1,!1}if(s&&s.isSymbolicLink())try{o=t.statSync(r)}catch(t){o=s}else o=s}this.statCache[r]=o;i=!0;return o&&(i=o.isDirectory()?"DIR":"FILE"),this.cache[r]=this.cache[r]||i,(!n||"FILE"!==i)&&i},Dr.prototype._mark=function(t){return jr.mark(this,t)},Dr.prototype._makeAbs=function(t){return jr.makeAbs(this,t)};var Rr=function t(e,r){if(e&&r)return t(e)(r);if("function"!=typeof e)throw new TypeError("need wrapper function");Object.keys(e).forEach(function(t){n[t]=e[t]});return n;function n(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var n=e.apply(this,t),i=t[t.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(t){n[t]=i[t]}),n}};var Cr=Rr(Mr),Pr=Rr($r);function Mr(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function $r(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}Mr.proto=Mr(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Mr(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return $r(this)},configurable:!0})}),Cr.strict=Pr;var Gr=Object.create(null),Br=Rr(function(t,e){return Gr[t]?(Gr[t].push(e),null):(Gr[t]=[e],function(t){return Cr(function e(){var r=Gr[t],n=r.length,i=function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}(arguments);try{for(var o=0;o<n;o++)r[o].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,i)})):delete Gr[t]}})}(t))});var Jr=zr,Ur=c.EventEmitter,Wr=jr.setopts,qr=jr.ownProp,Yr=jr.childrenIgnored,Qr=jr.isIgnored;function zr(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return xr(t,e)}return new Vr(t,e,r)}zr.sync=xr;var Kr=zr.GlobSync=xr.GlobSync;function Vr(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new Kr(t,e)}if(!(this instanceof Vr))return new Vr(t,e,r);Wr(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=Cr(r),this.on("error",r),this.on("end",function(t){r(null,t)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return c();for(var o=!0,s=0;s<n;s++)this._process(this.minimatch.set[s],s,!1,c);function c(){--i._processing,i._processing<=0&&(o?process.nextTick(function(){i._finish()}):i._finish())}o=!1}zr.glob=zr,zr.hasMagic=function(t,e){var r=function(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}({},e);r.noprocess=!0;var n=new Vr(t,r).minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},zr.Glob=Vr,or(Vr,Ur),Vr.prototype._finish=function(){if(i(this instanceof Vr),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();jr.finish(this),this.emit("end",this.found)}},Vr.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--t&&e._finish()}},Vr.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),i=this,o=n.length;if(0===o)return e();var s=this.matches[t]=Object.create(null);n.forEach(function(r,n){r=i._makeAbs(r),ve.realpath(r,i.realpathCache,function(n,c){n?"stat"===n.syscall?s[r]=!0:i.emit("error",n):s[c]=!0,0==--o&&(i.matches[t]=s,e())})})},Vr.prototype._mark=function(t){return jr.mark(this,t)},Vr.prototype._makeAbs=function(t){return jr.makeAbs(this,t)},Vr.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Vr.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Vr.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},Vr.prototype._process=function(t,e,r,n){if(i(this instanceof Vr),i("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,r,n]);else{for(var o,s=0;"string"==typeof t[s];)s++;switch(s){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:o=null;break;default:o=t.slice(0,s).join("/")}var c,a=t.slice(s);null===o?c=".":ar(o)||ar(t.join("/"))?(o&&ar(o)||(o="/"+o),c=o):c=o;var u=this._makeAbs(c);if(Yr(this,c))return n();a[0]===Ue.GLOBSTAR?this._processGlobStar(o,c,u,a,e,r,n):this._processReaddir(o,c,u,a,e,r,n)}},Vr.prototype._processReaddir=function(t,e,r,n,i,o,s){var c=this;this._readdir(r,o,function(a,u){return c._processReaddir2(t,e,r,n,i,o,u,s)})},Vr.prototype._processReaddir2=function(t,e,r,n,i,s,c,a){if(!c)return a();for(var u=n[0],f=!!this.minimatch.negate,h=u._glob,l=this.dot||"."===h.charAt(0),p=[],d=0;d<c.length;d++){if("."!==(m=c[d]).charAt(0)||l)(f&&!t?!m.match(u):m.match(u))&&p.push(m)}var y=p.length;if(0===y)return a();if(1===n.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(d=0;d<y;d++){var m=p[d];t&&(m="/"!==t?t+"/"+m:t+m),"/"!==m.charAt(0)||this.nomount||(m=o.join(this.root,m)),this._emitMatch(i,m)}return a()}n.shift();for(d=0;d<y;d++){m=p[d];t&&(m="/"!==t?t+"/"+m:t+m),this._process([m].concat(n),i,s,a)}a()},Vr.prototype._emitMatch=function(t,e){if(!this.aborted&&!Qr(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=ar(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}},Vr.prototype._readdirInGlobStar=function(e,r){if(!this.aborted){if(this.follow)return this._readdir(e,!1,r);var n=this,i=Br("lstat\0"+e,function(t,i){if(t&&"ENOENT"===t.code)return r();var o=i&&i.isSymbolicLink();n.symlinks[e]=o,o||!i||i.isDirectory()?n._readdir(e,!1,r):(n.cache[e]="FILE",r())});i&&t.lstat(e,i)}},Vr.prototype._readdir=function(e,r,n){if(!this.aborted&&(n=Br("readdir\0"+e+"\0"+r,n))){if(r&&!qr(this.symlinks,e))return this._readdirInGlobStar(e,n);if(qr(this.cache,e)){var i=this.cache[e];if(!i||"FILE"===i)return n();if(Array.isArray(i))return n(null,i)}t.readdir(e,function(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}(this,e,n))}},Vr.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];i="/"===t?t+i:t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}},Vr.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},Vr.prototype._processGlobStar=function(t,e,r,n,i,o,s){var c=this;this._readdir(r,o,function(a,u){c._processGlobStar2(t,e,r,n,i,o,u,s)})},Vr.prototype._processGlobStar2=function(t,e,r,n,i,o,s,c){if(!s)return c();var a=n.slice(1),u=t?[t]:[],f=u.concat(a);this._process(f,i,!1,c);var h=this.symlinks[r],l=s.length;if(h&&o)return c();for(var p=0;p<l;p++){if("."!==s[p].charAt(0)||this.dot){var d=u.concat(s[p],a);this._process(d,i,!0,c);var y=u.concat(s[p],n);this._process(y,i,!0,c)}}c()},Vr.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(i,o){n._processSimple2(t,e,i,o,r)})},Vr.prototype._processSimple2=function(t,e,r,n,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return i();if(t&&ar(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=o.join(this.root,t):(t=o.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()},Vr.prototype._stat=function(e,r){var n=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return r();if(!this.stat&&qr(this.cache,n)){var o=this.cache[n];if(Array.isArray(o)&&(o="DIR"),!i||"DIR"===o)return r(null,o);if(i&&"FILE"===o)return r()}var s=this.statCache[n];if(void 0!==s){if(!1===s)return r(null,s);var c=s.isDirectory()?"DIR":"FILE";return i&&"FILE"===c?r():r(null,c,s)}var a=this,u=Br("stat\0"+n,function(i,o){if(o&&o.isSymbolicLink())return t.stat(n,function(t,i){t?a._stat2(e,n,null,o,r):a._stat2(e,n,t,i,r)});a._stat2(e,n,i,o,r)});u&&t.lstat(n,u)},Vr.prototype._stat2=function(t,e,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,i();var o="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,o&&"FILE"===s?i():i(null,s,n)};var Xr=(t=16)=>{(t<=0||"number"!=typeof t)&&(t=16);let e="";for(;t--;)e+=Math.floor(16*Math.random()+1).toString(16).toUpperCase();return e};const Zr={path:"./data/",spaces:2,random:()=>Xr(5),sync:{create:!0,read:!1,update:!0,delete:!0}};module.exports=class{constructor(t=Zr){this._options=Object.assign({},Zr,t,{sync:Object.assign({},Zr.sync,t.sync)},{format:Object.assign({},Zr.format,t.format)}),this._options.path+=this._options.path.endsWith("/")?"":"/",this._cards={}}_card_path(t){return`${this._options.path}${t}.json`}async init(){return new Promise(t=>{fe.ensureDir(this._options.path,e=>{e&&console.error(e),t()})})}async load(){return await this.init(),new Promise(t=>{Jr(`${this._options.path}**/*.json`,{},(e,r)=>{e&&console.error(e),r.forEach(t=>{const e=fe.readJsonSync(t,t=>{t&&console.error(t)});this._cards[e.id]=e}),t(!0)})})}async create(t={},e=this._options.sync.create){return t.id||(t.id=this._options.random()),new Promise(r=>{const n=this._card_path(t.id);fe.writeJson(n,t,{spaces:this._options.spaces},n=>{n&&console.error(n),!0===e&&setTimeout(()=>r(t))}),this._cards[t.id]=t,!1===e&&setTimeout(()=>r(t))})}async read(t){return new Promise(e=>{t||e(Object.values(this._cards)),e(this._cards[t])})}async update(t,e=this._options.sync.update){return new Promise(async r=>{r(await this.create(t,e))})}async delete(t,e=this._options.sync.update){return new Promise(r=>{t&&this._cards[t]||r(!1);const n=this._card_path(t);fe.remove(n,t=>{t&&console.error(t),!0===e&&r(!0)}),delete this._cards[t],!1===e&&r(!0)})}};
